---
title: 模数转换器 (ADC) 深入详解
date: 2024-06-14 06:24:00
tags:
  - 2024
  - 电子元件
  - 嵌入式系统
  - 硬件编程
categories:
  - 嵌入式系统
  - 电子元件
mathjax: true
---

> **模数转换器 (Analog-to-Digital Converter, ADC)** 是电子系统中一个核心组件，它在模拟世界和数字世界之间架起了一座桥梁。它能够将连续变化的模拟信号（通常是电压或电流）转换为离散的数字信号，使得微控制器、数字信号处理器 (DSP) 等数字电路能够理解、处理和存储来自物理世界的模拟信息。

{% note info %}
**核心思想：** ADC 的本质是对模拟信号进行**采样 (Sampling)**、**量化 (Quantization)** 和**编码 (Encoding)**，从而将其离散化为计算机可以识别的二进制数值。
{% endnote %}
------

## 一、为什么需要 ADC？

我们的物理世界充满了模拟信号：
*   **温度**：连续变化的电压
*   **光照强度**：连续变化的电压或电流
*   **声音**：连续变化的声压波
*   **压力**：连续变化的电压

然而，现代的微控制器、计算机和数字通信系统都工作在**数字域**。它们只能处理高低电平（0 和 1）的离散信号。为了让数字系统能够处理模拟信息，就需要一个中间环节来完成**模数转换**。

**ADC 的作用：**

*   将传感器输出的模拟电压/电流转换为数字值。
*   实现物理世界信息（如温度、湿度、光照、声音、运动等）的数字化。
*   为数据采集、控制系统、通信、音频/视频处理等应用提供基础数据。

## 二、ADC 的基本工作原理

ADC 的转换过程主要分为三个步骤：

### 2.1 采样 (Sampling)

**概念**：采样是指在时间上对连续的模拟信号进行离散化。ADC 在预设的时间间隔内（采样周期）获取模拟信号的瞬时值。

**奈奎斯特-香农采样定理 (Nyquist-Shannon Sampling Theorem)**：
为了无失真地从采样数据中恢复原始模拟信号，采样频率 ($f_s$) 必须至少是原始模拟信号最高频率成分 ($f_{max}$) 的两倍。
$f_s \geq 2 \times f_{max}$

**影响**：如果采样频率过低，会导致**混叠 (Aliasing)** 现象，即高频信号在采样后被误识别为低频信号，导致数据失真。

{% mermaid %}
graph TD
    AnalogInput["模拟信号 (连续)"] --> SampleAndHold(采样保持电路)
    SampleAndHold --> DiscreteSamples[离散采样值]
    DiscreteSamples --> QuantizationStep
{% endmermaid %}

### 2.2 量化 (Quantization)

**概念**：量化是指在幅度上对连续的采样值进行离散化。将每个采样到的模拟电压值，映射到 ADC 能够表示的最近的数字级别上。

**分辨率 (Resolution)**：ADC 的分辨率决定了它能将输入电压细分成多少个离散级别。
*   通常用位数 `N` 表示，例如 8 位、10 位、12 位、16 位等。
*   `N` 位 ADC 可以表示 $2^N$ 个不同的数字级别。
*   分辨率越高，量化步长越小，测量精度越高，但转换速度通常越慢，成本越高。

**量化步长 (Quantization Step)**：每个数字级别所代表的最小电压变化量。
$量化步长 = \frac{模拟输入电压范围}{2^N}$

**量化误差 (Quantization Error)**：由于模拟值被强制映射到离散级别，因此会引入误差，最大误差通常是量化步长的一半。

{% mermaid %}
graph TD
    DiscreteSamples --> Quantizer(量化器)
    Quantizer --> QuantizedValues["量化值 (离散幅度)"]
    Quantizer -- "由" --> Resolution[分辨率 N位]
    Quantizer -- "产生" --> QuantizationError[量化误差]
{% endmermaid %}

### 2.3 编码 (Encoding)

**概念**：编码是将量化后的数字级别转换为二进制代码，作为 ADC 的最终输出。

**输出格式**：通常是二进制补码、偏移二进制、格雷码等，最常见的是**无符号二进制**。

{% mermaid %}
graph TD
    QuantizedValues --> Encoder(编码器)
    Encoder --> DigitalOutput["数字输出 (二进制)"]
    Encoder -- "遵循" --> OutputFormat[输出格式]
{% endmermaid %}

## 三、ADC 的关键性能指标

除了采样、量化和编码，评估 ADC 性能还需要考虑以下指标：

1.  **模拟输入电压范围 (Input Voltage Range)**：ADC 能够正确转换的最小和最大模拟电压。超出此范围可能导致饱和或损坏。
2.  **参考电压 (Reference Voltage, Vref)**：ADC 用来作为转换基准的电压。它直接影响量化步长和测量范围。
    *   **内部 Vref**：由芯片内部提供，可能受温度和电源波动影响。
    *   **外部 Vref**：由外部精密电压源提供，可提高精度和稳定性。
3.  **转换时间 (Conversion Time)**：完成一次模数转换所需的时间。
    *   决定了 ADC 的最大采样率。
    *   不同的 ADC 架构有不同的转换速度。
4.  **功耗 (Power Consumption)**：ADC 在工作时消耗的电量，对于低功耗应用（如电池供电设备）非常重要。
5.  **线性度 (Linearity)**：
    *   **差分非线性 (DNL - Differential Non-Linearity)**：相邻两个量化步长之间的偏差。
    *   **积分非线性 (INL - Integral Non-Linearity)**：ADC 的实际传输函数与理想传输函数之间的最大偏差。
    *   理想 ADC 的 DNL 和 INL 均为 0。
6.  **信噪比 (SNR - Signal-to-Noise Ratio)**：信号功率与噪声功率之比，衡量 ADC 输出的质量。
7.  **有效位数 (ENOB - Effective Number Of Bits)**：表示 ADC 在实际工作条件下能达到的实际分辨率，考虑了所有噪声和非线性因素。

## 四、常见的 ADC 架构类型

不同的 ADC 架构在速度、精度、功耗和成本上有所权衡。

### 4.1 逐次逼近型 ADC (SAR ADC - Successive Approximation Register ADC)

*   **工作原理**：通过一个比较器和数模转换器 (DAC) 逐位逼近模拟输入电压。从最高有效位 (MSB) 开始，通过与内部 DAC 输出比较来判断当前位是 0 还是 1，直到所有位确定。
*   **特点**：
    *   **中等速度和精度**：是嵌入式微控制器中最常见的 ADC 类型。
    *   **相对简单**：易于集成。
    *   转换时间与分辨率成正比 ($N$ 次比较)。
*   **适用场景**：通用数据采集、传感器接口、电池电压监测等。
*   **ESP32 的 ADC 就是 SAR 型。**

{% mermaid %}
graph TD
    AnalogInputSAR[模拟输入] --> SampleAndHoldSAR(采样保持)
    SampleAndHoldSAR --> Comparator(比较器)
    Comparator --> SAR(逐次逼近寄存器)
    SAR --> DAC(数模转换器)
    DAC --> Comparator
    SAR --> DigitalOutputSAR[数字输出]
{% endmermaid %}

### 4.2 闪速 ADC (Flash ADC)

*   **工作原理**：使用 $2^N - 1$ 个比较器并行比较输入电压与 $2^N - 1$ 个预设的参考电压。所有比较结果同时输出，然后通过编码器直接转换为数字值。
*   **特点**：
    *   **速度最快**：单周期转换。
    *   **功耗高，面积大，成本高**：需要大量比较器和电阻。
*   **适用场景**：雷达、高速示波器、视频数字化等极高采样率应用。

### 4.3 Delta-Sigma (ΔΣ) ADC

*   **工作原理**：通过过采样、噪声整形和数字滤波技术，将低分辨率的量化结果转换为高分辨率的输出。
*   **特点**：
    *   **高精度**：可达 16-24 位甚至更高。
    *   **低速**：转换时间相对较长。
    *   对噪声具有良好抑制能力。
*   **适用场景**：高精度测量、音频处理、精密仪器仪表、物联网传感器节点等。

### 4.4 双斜率积分型 ADC (Dual-Slope Integrating ADC)

*   **工作原理**：通过两次积分来测量输入电压。第一次对输入电压积分固定时间，第二次用一个已知参考电压反向积分直到回到零。根据第二次积分的时间来计算输入电压。
*   **特点**：
    *   **高精度**：对噪声和电源纹波有很强的抑制能力。
    *   **速度最慢**。
*   **适用场景**：数字万用表、称重传感器、高精度工业控制等。

## 五、总结

ADC 是数字系统与模拟世界交互的关键接口。理解其基本工作原理（采样、量化、编码）和关键性能指标（分辨率、采样率、参考电压、线性度等）对于正确选择和使用 ADC 至关重要。不同的应用场景和性能要求将决定采用哪种架构的 ADC。随着技术发展，ADC 正在不断提高速度、精度、降低功耗和成本，在各个领域发挥着越来越重要的作用。