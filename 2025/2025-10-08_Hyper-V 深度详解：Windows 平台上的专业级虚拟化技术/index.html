<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Hyper-V 深度详解：Windows 平台上的专业级虚拟化技术 | 1024 维度</title><meta name="author" content="TeaTang"><meta name="copyright" content="TeaTang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Hyper-V 是微软提供的一款基于 Hypervisor 的虚拟化技术，它允许用户在单一物理服务器上运行多个独立的虚拟机 (Virtual Machines, VMs)。作为 Windows Server 操作系统的一个角色功能，以及 Windows 客户端操作系统（Pro、Enterprise、Education 版本）的一个可选功能，Hyper-V 提供了一个可靠、高效且可扩展的平台，用于">
<meta property="og:type" content="article">
<meta property="og:title" content="Hyper-V 深度详解：Windows 平台上的专业级虚拟化技术">
<meta property="og:url" content="https://blog.tbf1211.xx.kg/2025/2025-10-08_Hyper-V%20%E6%B7%B1%E5%BA%A6%E8%AF%A6%E8%A7%A3%EF%BC%9AWindows%20%E5%B9%B3%E5%8F%B0%E4%B8%8A%E7%9A%84%E4%B8%93%E4%B8%9A%E7%BA%A7%E8%99%9A%E6%8B%9F%E5%8C%96%E6%8A%80%E6%9C%AF/index.html">
<meta property="og:site_name" content="1024 维度">
<meta property="og:description" content="Hyper-V 是微软提供的一款基于 Hypervisor 的虚拟化技术，它允许用户在单一物理服务器上运行多个独立的虚拟机 (Virtual Machines, VMs)。作为 Windows Server 操作系统的一个角色功能，以及 Windows 客户端操作系统（Pro、Enterprise、Education 版本）的一个可选功能，Hyper-V 提供了一个可靠、高效且可扩展的平台，用于">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog.tbf1211.xx.kg/img/cover/default_cover-18.jpg">
<meta property="article:published_time" content="2025-10-07T22:24:00.000Z">
<meta property="article:modified_time" content="2025-11-04T14:38:45.817Z">
<meta property="article:author" content="TeaTang">
<meta property="article:tag" content="2025">
<meta property="article:tag" content="Hyper-V">
<meta property="article:tag" content="虚拟机">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.tbf1211.xx.kg/img/cover/default_cover-18.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Hyper-V 深度详解：Windows 平台上的专业级虚拟化技术",
  "url": "https://blog.tbf1211.xx.kg/2025/2025-10-08_Hyper-V%20%E6%B7%B1%E5%BA%A6%E8%AF%A6%E8%A7%A3%EF%BC%9AWindows%20%E5%B9%B3%E5%8F%B0%E4%B8%8A%E7%9A%84%E4%B8%93%E4%B8%9A%E7%BA%A7%E8%99%9A%E6%8B%9F%E5%8C%96%E6%8A%80%E6%9C%AF/",
  "image": "https://blog.tbf1211.xx.kg/img/cover/default_cover-18.jpg",
  "datePublished": "2025-10-07T22:24:00.000Z",
  "dateModified": "2025-11-04T14:38:45.817Z",
  "author": [
    {
      "@type": "Person",
      "name": "TeaTang",
      "url": "https://blog.tbf1211.xx.kg"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon-1.ico"><link rel="canonical" href="https://blog.tbf1211.xx.kg/2025/2025-10-08_Hyper-V%20%E6%B7%B1%E5%BA%A6%E8%AF%A6%E8%A7%A3%EF%BC%9AWindows%20%E5%B9%B3%E5%8F%B0%E4%B8%8A%E7%9A%84%E4%B8%93%E4%B8%9A%E7%BA%A7%E8%99%9A%E6%8B%9F%E5%8C%96%E6%8A%80%E6%9C%AF/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><meta name="google-site-verification" content="NdIUXAOVyGnnBhcrip0ksCawbdAzT0hlBZDE9u4jx6k"/><meta name="msvalidate.01" content="567E47D75E8DCF1282B9623AD914701E"/><meta name="baidu-site-verification" content="code-pE5rnuxcfD"/><link rel="stylesheet" href="/css/index.css?v=5.5.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          const mediaQueryDark = window.matchMedia('(prefers-color-scheme: dark)')
          const mediaQueryLight = window.matchMedia('(prefers-color-scheme: light)')

          if (theme === undefined) {
            if (mediaQueryLight.matches) activateLightMode()
            else if (mediaQueryDark.matches) activateDarkMode()
            else {
              const hour = new Date().getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            mediaQueryDark.addEventListener('change', () => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else {
            theme === 'light' ? activateLightMode() : activateDarkMode()
          }
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.json","preload":false,"top_n_per_article":1,"unescape":false,"pagination":{"enable":true,"hitsPerPage":8},"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":400,"highlightFullpage":true,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":150,"languages":{"author":"作者: TeaTang","link":"链接: ","source":"来源: 1024 维度","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Hyper-V 深度详解：Windows 平台上的专业级虚拟化技术',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="preconnect" href="https://jsd.012700.xyz"><link href="/self/btf.css" rel="stylesheet"><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="1024 维度" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/loading.gif" data-lazy-src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">217</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">173</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">62</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 我的轨迹</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/2023/"><i class="fa-fw fa-solid fa-bug"></i><span> 2023</span></a></li><li><a class="site-page child" href="/archives/2024/"><i class="fa-fw fa-solid fa-code"></i><span> 2024</span></a></li><li><a class="site-page child" href="/archives/2025/"><i class="fa-fw fa-solid fa-network-wired"></i><span> 2025</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa-solid fa-calendar-days"></i><span> 时间线</span></a></div><div class="menus_item"><a class="site-page" href="/shuoshuo"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url(/img/cover/default_cover-18.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">1024 维度</span></a><a class="nav-page-title" href="/"><span class="site-name">Hyper-V 深度详解：Windows 平台上的专业级虚拟化技术</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 我的轨迹</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/2023/"><i class="fa-fw fa-solid fa-bug"></i><span> 2023</span></a></li><li><a class="site-page child" href="/archives/2024/"><i class="fa-fw fa-solid fa-code"></i><span> 2024</span></a></li><li><a class="site-page child" href="/archives/2025/"><i class="fa-fw fa-solid fa-network-wired"></i><span> 2025</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa-solid fa-calendar-days"></i><span> 时间线</span></a></div><div class="menus_item"><a class="site-page" href="/shuoshuo"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Hyper-V 深度详解：Windows 平台上的专业级虚拟化技术</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2025-10-07T22:24:00.000Z" title="发表于 2025-10-08 06:24:00">2025-10-08</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/">开发工具</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/%E8%99%9A%E6%8B%9F%E6%9C%BA/">虚拟机</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">3.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>11分钟</span></span><span class="post-meta-separator">|</span><span id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="umamiPV" data-path="/2025/2025-10-08_Hyper-V%20%E6%B7%B1%E5%BA%A6%E8%AF%A6%E8%A7%A3%EF%BC%9AWindows%20%E5%B9%B3%E5%8F%B0%E4%B8%8A%E7%9A%84%E4%B8%93%E4%B8%9A%E7%BA%A7%E8%99%9A%E6%8B%9F%E5%8C%96%E6%8A%80%E6%9C%AF/"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><blockquote>
<p><strong>Hyper-V</strong> 是微软提供的一款<strong>基于 Hypervisor 的虚拟化技术</strong>，它允许用户在单一物理服务器上运行多个独立的虚拟机 (Virtual Machines, VMs)。作为 Windows Server 操作系统的一个角色功能，以及 Windows 客户端操作系统（Pro、Enterprise、Education 版本）的一个可选功能，Hyper-V 提供了一个可靠、高效且可扩展的平台，用于创建、运行和管理虚拟机。它支持运行多种操作系统，包括 Windows、Linux 以及其他变体，是企业级数据中心、开发测试环境以及个人专业用户不可或缺的工具。</p>
</blockquote>
<div class="note info flat"><p><strong>核心思想</strong>：Hyper-V 在硬件和操作系统之间插入一个薄薄的虚拟化层——<strong>Hypervisor (管理程序)</strong>。这个 Hypervisor 直接管理物理硬件资源，并高效地分配给多个虚拟机，每个虚拟机都像一台独立的物理机器一样运行，拥有自己的操作系统和应用程序，从而实现资源的隔离和高效利用。</p>
</div>
<hr>
<h2 id="一、虚拟化技术概述与-Hyper-V-的定位"><a href="#一、虚拟化技术概述与-Hyper-V-的定位" class="headerlink" title="一、虚拟化技术概述与 Hyper-V 的定位"></a>一、虚拟化技术概述与 Hyper-V 的定位</h2><h3 id="1-1-什么是虚拟化？"><a href="#1-1-什么是虚拟化？" class="headerlink" title="1.1 什么是虚拟化？"></a>1.1 什么是虚拟化？</h3><p>虚拟化是一种创建事物虚拟版本（而不是物理版本）的技术，通常指创建虚拟计算机硬件平台、存储设备或网络资源。它的核心目标是：</p>
<ul>
<li><strong>资源利用率最大化</strong>：减少物理服务器的数量，提高硬件资源的利用率。</li>
<li><strong>隔离性</strong>：将不同的应用程序和操作系统隔离在各自的虚拟机中，互不影响。</li>
<li><strong>灵活性和可伸缩性</strong>：快速创建、部署和管理虚拟机，支持动态资源分配。</li>
<li><strong>灾难恢复和高可用性</strong>：简化备份、恢复和故障转移流程。</li>
</ul>
<h3 id="1-2-虚拟化类型：Hyper-V-的归属"><a href="#1-2-虚拟化类型：Hyper-V-的归属" class="headerlink" title="1.2 虚拟化类型：Hyper-V 的归属"></a>1.2 虚拟化类型：Hyper-V 的归属</h3><p>虚拟化主要分为两种类型：</p>
<ol>
<li><strong>宿主式虚拟化 (Type 2 Hypervisor)</strong>：Hypervisor 运行在现有操作系统之上，例如 VirtualBox、VMware Workstation。性能开销较大，因为 Guest OS 的请求需要经过 Host OS 再到硬件。</li>
<li><strong>裸金属虚拟化 (Type 1 Hypervisor &#x2F; Native Hypervisor)</strong>：Hypervisor 直接运行在物理硬件之上，管理并分配资源给 Guest OS。Host OS (通常是精简的管理 OS 或甚至没有独立的 Host OS) 本身也作为一个特殊的虚拟机运行。这种方式性能开销小，效率高，是企业级虚拟化的主流。</li>
</ol>
<p><strong>Hyper-V 属于裸金属虚拟化 (Type 1 Hypervisor)</strong>。在 Hyper-V 架构中：</p>
<ul>
<li>当你在 Windows Server 或 Windows 客户端上启用 Hyper-V 功能时，Windows 的原始操作系统（称为<strong>父分区</strong>或 <strong>Parent Partition</strong>）本身会被 Hyper-V Hypervisor 虚拟化，成为一个特殊的虚拟机。</li>
<li>Hyper-V Hypervisor 直接控制物理硬件，并为所有虚拟机（包括父分区和用户创建的子分区）提供服务。</li>
</ul>
<h3 id="1-3-Hyper-V-的优势"><a href="#1-3-Hyper-V-的优势" class="headerlink" title="1.3 Hyper-V 的优势"></a>1.3 Hyper-V 的优势</h3><ol>
<li><strong>深度集成 Windows 生态系统</strong>：作为微软产品，与 Windows Server、Azure、System Center 等无缝集成。</li>
<li><strong>灵活性</strong>：支持多种操作系统作为 Guest OS，包括 Windows 各版本、Linux 各发行版、FreeBSD 等。</li>
<li><strong>经济高效</strong>：在 Windows Server 上作为免费角色功能提供，Windows 客户端版本也内置。</li>
<li><strong>可扩展性</strong>：支持大型虚拟机 (如 240 个虚拟处理器、24TB 内存) 和容错集群。</li>
<li><strong>安全性</strong>：支持安全启动、虚拟 TPM (Trusted Platform Module) 等安全功能。</li>
</ol>
<h2 id="二、Hyper-V-技术架构详解"><a href="#二、Hyper-V-技术架构详解" class="headerlink" title="二、Hyper-V 技术架构详解"></a>二、Hyper-V 技术架构详解</h2><p>Hyper-V 基于微内核 Hypervisor 架构。理解其架构对于理解其工作原理至关重要。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">graph TD</span><br><span class="line">    Hardware[物理硬件: CPU, 内存, 存储, 网络]</span><br><span class="line"></span><br><span class="line">    subgraph Hyper-V 架构</span><br><span class="line">        HV[Hyper-V Hypervisor]</span><br><span class="line"></span><br><span class="line">        ParentOS[父分区 (Parent Partition)]</span><br><span class="line">        ParentOS -- VMBus --&gt; HV</span><br><span class="line">        ParentOS -- WMI Providers --&gt; 管理工具</span><br><span class="line"></span><br><span class="line">        ChildVM1[子分区 (Child Partition) Guest OS 1]</span><br><span class="line">        ChildVM1 -- VMBus --&gt; HV</span><br><span class="line">        ChildVM1 -- Enlightened I/O --&gt; HV (直接访问)</span><br><span class="line"></span><br><span class="line">        ChildVM2[子分区 (Child Partition) Guest OS 2]</span><br><span class="line">        ChildVM2 -- VMBus --&gt; HV</span><br><span class="line">        ChildVM2 -- Enlightened I/O --&gt; HV (直接访问)</span><br><span class="line">    end</span><br><span class="line"></span><br><span class="line">    Hardware --- HV</span><br></pre></td></tr></table></figure>

<ol>
<li><strong>Hyper-V Hypervisor</strong>：<ul>
<li>这是 Hyper-V 最核心的组件。它是一个薄薄的软件层，直接运行在物理硬件之上。</li>
<li>主要职责是虚拟化物理硬件资源 (CPU、内存、I&#x2F;O 设备)，并为所有虚拟机提供一个隔离的运行环境。</li>
<li>它不包含设备驱动程序，而是依赖于父分区来提供大部分 I&#x2F;O 服务。</li>
</ul>
</li>
<li><strong>父分区 (Parent Partition)</strong>：<ul>
<li>在启用 Hyper-V 后，安装有 Windows Server 或 Windows 客户端的物理操作系统会被 Hypervisor 虚拟化为一个特殊的虚拟机，称为父分区。</li>
<li>父分区拥有对物理硬件的直接访问能力 (但仍然通过 Hypervisor)。</li>
<li>它的主要职责是：<ul>
<li><strong>管理 Hypervisor</strong>：通过 Hyper-V WMI Provider 和管理堆栈与 Hypervisor 交互。</li>
<li><strong>提供 I&#x2F;O 虚拟化服务</strong>：为子分区提供虚拟化的 I&#x2F;O 设备（如虚拟网络适配器、虚拟存储控制器）。当子分区需要访问物理 I&#x2F;O 时，请求会通过 VMBus 路由到父分区，由父分区使用其物理设备驱动程序来完成操作。</li>
</ul>
</li>
</ul>
</li>
<li><strong>子分区 (Child Partition)</strong>：<ul>
<li>这些是用户创建的、运行 Guest OS 的虚拟机。</li>
<li>子分区没有直接访问物理硬件的能力。所有的硬件请求都必须通过 VMBus (Virtual Machine Bus) 路由到 Hypervisor。</li>
<li>为了提高 I&#x2F;O 性能，现代 Guest OS 通常会安装<strong>集成服务 (Integration Services)</strong>。集成服务包含<strong>虚拟服务客户端 (VSC)</strong> 驱动程序，它们是专门为虚拟化环境编写的，能够通过 VMBus 与 Hypervisor 的<strong>虚拟服务提供程序 (VSP)</strong> 进行** Enlightened I&#x2F;O (优化I&#x2F;O)**。这意味着 Guest OS 可以“知道”它正在虚拟化环境中运行，并直接向 Hypervisor 发送更高效的 I&#x2F;O 请求，而不是模拟复杂的传统硬件。</li>
<li>如果没有安装集成服务，Guest OS 将使用<strong>仿真设备 (Emulated Devices)</strong>，性能会相对较低。</li>
</ul>
</li>
</ol>
<h2 id="三、Hyper-V-的核心功能"><a href="#三、Hyper-V-的核心功能" class="headerlink" title="三、Hyper-V 的核心功能"></a>三、Hyper-V 的核心功能</h2><ol>
<li><strong>虚拟机管理 (VM Management)</strong>：<ul>
<li><strong>创建&#x2F;配置 VM</strong>：通过 Hyper-V 管理器、PowerShell 或 SCVMM (System Center Virtual Machine Manager) 创建虚拟机，配置虚拟处理器、内存、存储和网络。</li>
<li><strong>快照 (Checkpoints)</strong>：捕获虚拟机在某一时刻的状态，以便随时回滚。适用于开发测试或系统恢复。</li>
<li><strong>导入&#x2F;导出 VM</strong>：方便地迁移虚拟机。</li>
<li><strong>高可用性 (High Availability)</strong>：结合 Windows Server Failover Clustering (WSFC)，实现虚拟机的故障转移和实时迁移。</li>
</ul>
</li>
<li><strong>虚拟存储 (Virtual Storage)</strong>：<ul>
<li><strong>VHD&#x2F;VHDX 格式</strong>：支持这两种虚拟硬盘格式。VHDX 格式支持更大的虚拟磁盘（最大 64TB）、更大的扇区大小、更强大的数据损坏保护，并能动态扩展。</li>
<li><strong>差分磁盘 (Differencing Disks)</strong>：用于存储父磁盘的更改，节省空间并简化管理。</li>
<li><strong>直通磁盘 (Pass-through Disks)</strong>：允许虚拟机直接访问物理磁盘，适用于需要高性能 I&#x2F;O 或文件加密的场景。</li>
<li><strong>共享 VHDX (Shared VHDX)</strong>：允许多个虚拟机共享同一个虚拟硬盘，适用于构建 Windows Server Failover Cluster 中的 Guest Cluster 存储。</li>
</ul>
</li>
<li><strong>虚拟网络 (Virtual Networking)</strong>：<ul>
<li><strong>虚拟交换机 (Virtual Switch)</strong>：连接虚拟机到物理网络或隔离虚拟机网络。支持三种类型：<ul>
<li><strong>外部 (External)</strong>：连接虚拟机到物理网络，允许与物理网络中的其他计算机通信。</li>
<li><strong>内部 (Internal)</strong>：允许虚拟机与父分区以及其他内部虚拟机通信，但不直接连接到物理网络。</li>
<li><strong>私有 (Private)</strong>：仅允许虚拟机之间相互通信，与父分区和物理网络完全隔离。</li>
</ul>
</li>
<li><strong>网络适配器</strong>：为VM提供虚拟网卡，支持高级特性如 VLAN、MAC 地址欺骗、SR-IOV (Single Root I&#x2F;O Virtualization) 等。</li>
<li><strong>网络虚拟化 (Network Virtualization)</strong>：通过 SDN (Software-Defined Networking) 功能，实现网络的逻辑划分和隔离。</li>
</ul>
</li>
<li><strong>动态内存 (Dynamic Memory)</strong>：<ul>
<li>允许 Hyper-V 根据虚拟机的实际工作负载动态地调整分配给虚拟机的内存大小，从而提高物理内存的利用率。</li>
</ul>
</li>
<li><strong>远程管理</strong>：<ul>
<li>通过 Hyper-V 管理器客户端、RSAT 工具、PowerShell、Windows Admin Center (WAC) 等工具进行远程管理。</li>
</ul>
</li>
</ol>
<h2 id="四、Hyper-V-的部署与管理"><a href="#四、Hyper-V-的部署与管理" class="headerlink" title="四、Hyper-V 的部署与管理"></a>四、Hyper-V 的部署与管理</h2><h3 id="4-1-1-在-Windows-Server-上启用-Hyper-V"><a href="#4-1-1-在-Windows-Server-上启用-Hyper-V" class="headerlink" title="4.1 1. 在 Windows Server 上启用 Hyper-V"></a>4.1 1. 在 Windows Server 上启用 Hyper-V</h3><p>在 Windows Server 上，Hyper-V 作为一个服务器角色。</p>
<ul>
<li><strong>GUI 方式</strong>：通过服务器管理器 (Server Manager) 的“添加角色和功能向导 (Add Roles and Features Wizard)”启用 Hyper-V 角色。</li>
<li><strong>PowerShell 方式</strong>：<code>Install-WindowsFeature -Name Hyper-V -IncludeManagementTools -Restart</code></li>
</ul>
<h3 id="4-2-2-在-Windows-客户端上启用-Hyper-V"><a href="#4-2-2-在-Windows-客户端上启用-Hyper-V" class="headerlink" title="4.2 2. 在 Windows 客户端上启用 Hyper-V"></a>4.2 2. 在 Windows 客户端上启用 Hyper-V</h3><p>在 Windows 10&#x2F;11 Pro、Enterprise 或 Education 版本上，Hyper-V 作为一个可选功能。</p>
<ul>
<li><strong>GUI 方式</strong>：通过“控制面板”-&gt;“程序和功能”-&gt;“启用或关闭 Windows 功能”，勾选“Hyper-V”并重启。</li>
<li><strong>PowerShell 方式</strong>：<code>Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V -All</code></li>
</ul>
<h3 id="4-3-3-管理工具"><a href="#4-3-3-管理工具" class="headerlink" title="4.3 3. 管理工具"></a>4.3 3. 管理工具</h3><ul>
<li><strong>Hyper-V 管理器 (Hyper-V Manager)</strong>：图形化管理界面，用于创建、配置和运行虚拟机。</li>
<li><strong>PowerShell</strong>：强大的命令行工具，用于自动化Hyper-V管理。</li>
<li><strong>Windows Admin Center (WAC)</strong>：基于 Web 的管理工具，可管理服务器的 Hyper-V 角色。</li>
<li><strong>System Center Virtual Machine Manager (SCVMM)</strong>：企业级虚拟化管理平台，用于管理大规模的Hyper-V部署。</li>
</ul>
<h2 id="五、Hyper-V-的高级特性与应用场景"><a href="#五、Hyper-V-的高级特性与应用场景" class="headerlink" title="五、Hyper-V 的高级特性与应用场景"></a>五、Hyper-V 的高级特性与应用场景</h2><h3 id="5-1-1-灾难恢复与高可用性"><a href="#5-1-1-灾难恢复与高可用性" class="headerlink" title="5.1 1. 灾难恢复与高可用性"></a>5.1 1. 灾难恢复与高可用性</h3><ul>
<li><strong>复本 (Hyper-V Replica)</strong>：允许将虚拟机异步复制到备用 Hyper-V 主机，实现灾难恢复。</li>
<li><strong>实时迁移 (Live Migration)</strong>：在不中断虚拟机运行的情况下，将虚拟机从一台物理主机迁移到另一台物理主机，广泛用于负载均衡和主机维护。</li>
<li><strong>存储迁移 (Storage Migration)</strong>：在不中断虚拟机运行的情况下，迁移虚拟机的存储文件。</li>
</ul>
<h3 id="5-2-2-增强会话模式-Enhanced-Session-Mode"><a href="#5-2-2-增强会话模式-Enhanced-Session-Mode" class="headerlink" title="5.2 2. 增强会话模式 (Enhanced Session Mode)"></a>5.2 2. 增强会话模式 (Enhanced Session Mode)</h3><ul>
<li>通过 RDP (Remote Desktop Protocol) 技术，提供虚拟机与宿主机之间更佳的集成体验，包括剪贴板共享、驱动器重定向、USB 设备重定向等。</li>
</ul>
<h3 id="5-3-3-嵌套虚拟化-Nested-Virtualization"><a href="#5-3-3-嵌套虚拟化-Nested-Virtualization" class="headerlink" title="5.3 3. 嵌套虚拟化 (Nested Virtualization)"></a>5.3 3. 嵌套虚拟化 (Nested Virtualization)</h3><ul>
<li>允许在 Hyper-V 虚拟机中运行另一个 Hypervisor（例如在 Hyper-V VM 中安装 Hyper-V），适用于演示、测试和实验室环境。</li>
</ul>
<h3 id="5-4-4-Shielded-VMs-受防护的虚拟机"><a href="#5-4-4-Shielded-VMs-受防护的虚拟机" class="headerlink" title="5.4 4. Shielded VMs (受防护的虚拟机)"></a>5.4 4. Shielded VMs (受防护的虚拟机)</h3><ul>
<li>高度安全化的虚拟机，通过 vTPM (虚拟可信平台模块) 和主机守护服务 (Host Guardian Service) 保护 VM 及其数据不被恶意管理员或特权用户访问。适用于敏感工作负载。</li>
</ul>
<h3 id="5-5-5-Linux-集成服务"><a href="#5-5-5-Linux-集成服务" class="headerlink" title="5.5 5. Linux 集成服务"></a>5.5 5. Linux 集成服务</h3><ul>
<li>为 Linux Guest OS 提供优化驱动，提高性能和管理体验（如动态内存、快照、时间同步、KVP 交换、文件复制）。</li>
</ul>
<h3 id="5-6-6-应用场景"><a href="#5-6-6-应用场景" class="headerlink" title="5.6 6. 应用场景"></a>5.6 6. 应用场景</h3><ul>
<li><strong>服务器整合</strong>：减少物理服务器数量，降低运营成本。</li>
<li><strong>开发测试环境</strong>：快速搭建和销毁各种测试环境，方便开发和 QA。</li>
<li><strong>灾难恢复</strong>：通过 Hyper-V Replica 等功能实现业务连续性。</li>
<li><strong>虚拟桌面基础设施 (VDI)</strong>：提供集中管理的虚拟桌面。</li>
<li><strong>软件定义数据中心 (SDDC)</strong>：结合 SDN、SDS (Software-Defined Storage) 构建灵活的基础架构。</li>
</ul>
<h2 id="六、与-VMware-vSphere-ESXi-的比较"><a href="#六、与-VMware-vSphere-ESXi-的比较" class="headerlink" title="六、与 VMware vSphere&#x2F;ESXi 的比较"></a>六、与 VMware vSphere&#x2F;ESXi 的比较</h2><p>Hyper-V 是微软在虚拟化领域的旗舰产品，与 VMware 的 ESXi&#x2F;vSphere 是主要的竞争对手。</p>
<table>
<thead>
<tr>
<th align="left">特性&#x2F;产品</th>
<th align="left">Hyper-V</th>
<th align="left">VMware vSphere&#x2F;ESXi</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Hypervisor 类型</td>
<td align="left">Type 1</td>
<td align="left">Type 1</td>
</tr>
<tr>
<td align="left"><strong>集成度</strong></td>
<td align="left">与 Windows Server 和 Azure 生态系统深度集成</td>
<td align="left">独立的虚拟化平台，但与 VMware 生态集成度高</td>
</tr>
<tr>
<td align="left"><strong>成本</strong></td>
<td align="left">在 Windows Server 中作为角色免费，有高级功能授权</td>
<td align="left">ESXi 免费版功能有限，vSphere 企业版需授权购买</td>
</tr>
<tr>
<td align="left"><strong>管理工具</strong></td>
<td align="left">Hyper-V Manager, PowerShell, WAC, SCVMM</td>
<td align="left">vSphere Client, vCenter Server, PowerCLI</td>
</tr>
<tr>
<td align="left"><strong>性能</strong></td>
<td align="left">匹敌，对等</td>
<td align="left">匹敌，对等</td>
</tr>
<tr>
<td align="left"><strong>成熟度</strong></td>
<td align="left">相对年轻 (但已非常成熟)，迭代快</td>
<td align="left">业界领导者，历史悠久，生态丰富</td>
</tr>
<tr>
<td align="left"><strong>生态系统</strong></td>
<td align="left">微软系产品链的自然选择</td>
<td align="left">独立的庞大生态，支持各种硬件和第三方集成</td>
</tr>
</tbody></table>
<p>选择 Hyper-V 还是 VMware 通常取决于现有的 IT 基础设施、团队技能集、预算以及特定的业务需求。</p>
<h2 id="七、总结"><a href="#七、总结" class="headerlink" title="七、总结"></a>七、总结</h2><p>Hyper-V 是一款功能全面、性能优异的裸金属虚拟化解决方案。它作为 Windows Server 的核心组件，以及 Windows 客户端操作系统的内置功能，为个人用户、开发人员和数据中心提供了可靠的虚拟化平台。从服务器整合、开发测试，到灾难恢复、高可用性，再到更高级的受防护虚拟机和嵌套虚拟化，Hyper-V 都能胜任。随着云计算和容器化的兴起，Hyper-V 不仅自身不断发展，也与 Azure 混合云战略紧密结合，在现代 IT 基础架构中扮演着越来越重要的角色。对于Windows平台用户而言，掌握Hyper-V无疑是提升效率和实现复杂IT架构的关键技能。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://blog.tbf1211.xx.kg">TeaTang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://blog.tbf1211.xx.kg/2025/2025-10-08_Hyper-V%20%E6%B7%B1%E5%BA%A6%E8%AF%A6%E8%A7%A3%EF%BC%9AWindows%20%E5%B9%B3%E5%8F%B0%E4%B8%8A%E7%9A%84%E4%B8%93%E4%B8%9A%E7%BA%A7%E8%99%9A%E6%8B%9F%E5%8C%96%E6%8A%80%E6%9C%AF/">https://blog.tbf1211.xx.kg/2025/2025-10-08_Hyper-V%20%E6%B7%B1%E5%BA%A6%E8%AF%A6%E8%A7%A3%EF%BC%9AWindows%20%E5%B9%B3%E5%8F%B0%E4%B8%8A%E7%9A%84%E4%B8%93%E4%B8%9A%E7%BA%A7%E8%99%9A%E6%8B%9F%E5%8C%96%E6%8A%80%E6%9C%AF/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://blog.tbf1211.xx.kg" target="_blank">1024 维度</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/2025/">2025</a><a class="post-meta__tags" href="/tags/Hyper-V/">Hyper-V</a><a class="post-meta__tags" href="/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/">虚拟机</a></div><div class="post-share"><div class="social-share" data-image="/img/cover/default_cover-18.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/2025-10-10_NativeScript-Vue3%E8%AF%A6%E8%A7%A3/" title="NativeScript-Vue3详解"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-25.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">NativeScript-Vue3详解</div></div><div class="info-2"><div class="info-item-1"> NativeScript-Vue 3 是一个强大的框架组合，它允许开发者使用熟悉的 Vue 3 语法和工具链来构建真正的原生 iOS 和 Android 移动应用程序。与传统 Hybrid 应用（如 Cordova 或 Ionic）不同，NativeScript 直接操作原生 UI 组件，因此能够提供一流的性能和用户体验，同时避免了 Web 视图的性能瓶颈。  核心亮点：使用 Vue 3 渲染原生 UI 组件，实现高性能、媲美原生体验的跨平台移动应用开发。   一、什么是 NativeScript-Vue 3？1.1 NativeScript 简介NativeScript 是一个开源框架，用于使用 JavaScript、TypeScript 或其他编译到 JavaScript 的语言来构建原生移动应用程序。它的核心能力在于：  直接访问原生 API：无需编写任何 Objective-C&#x2F;Swift 或 Java&#x2F;Kotlin 代码，开发者可以直接从 JavaScript 访问设备的所有原生 API。 原生 UI 渲染：不使用 WebView，而是将 Java...</div></div></div></a><a class="pagination-related" href="/2025/2025-10-06_TresJS%E8%AF%A6%E8%A7%A3%EF%BC%9A%E7%94%A8Vue%E7%9A%84%E6%96%B9%E5%BC%8F%E6%9E%84%E5%BB%BAThree.js%E5%9C%BA%E6%99%AF/" title="TresJS详解：用Vue的方式构建Three.js场景"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-22.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">TresJS详解：用Vue的方式构建Three.js场景</div></div><div class="info-2"><div class="info-item-1"> TresJS 是一个基于 Vue.js 和 Three.js 的声明式 3D 渲染框架。它允许开发者像编写 Vue 组件一样，通过声明式的方式构建复杂的 Three.js 场景，从而大大降低 Three.js 的学习曲线和开发复杂度，特别适合 Vue 开发者快速进入 3D 领域。  核心思想：将 Three.js 对象抽象为 Vue 组件，用 Vue 的响应式和组件化思维管理 3D 场景。   一、什么是 TresJS？Three.js 是一个强大的 JavaScript 3D 库，用于在浏览器中创建和渲染 3D 图形。然而，直接使用 Three.js API 需要编写大量的命令式（或说是“指令式”）代码来创建几何体、材质、网格、灯光、摄像机、场景以及设置渲染循环等。这对于不熟悉 3D 图形编程的开发者来说，上手较难，且代码维护复杂。 TresJS 的出现就是为了解决这个问题。它提供了一套 Vue 组件，每个组件都对应 Three.js 中的一个核心概念（如 &lt;TresCanvas&gt;, &lt;TresMesh&gt;, &lt;TresPerspectiveCam...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/2025-09-22_WSL2%E8%AF%A6%E8%A7%A3%EF%BC%9A%E5%9C%A8Windows%E8%BF%90%E8%A1%8CLinux%E7%9A%84%E6%96%B0%E6%A0%87%E5%87%86/" title="WSL2详解：在Windows运行Linux的新标准"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-23.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-22</div><div class="info-item-2">WSL2详解：在Windows运行Linux的新标准</div></div><div class="info-2"><div class="info-item-1"> WSL 2 (Windows Subsystem for Linux 2) 是微软对 WSL 架构的重大革新，它提供了一个运行在轻量级虚拟机中的完整 Linux 内核。相较于其前身 WSL 1，WSL 2 实现了更强的 Linux 系统调用兼容性、显著提升的文件系统性能，并为 Docker Desktop 等需要原生 Linux 内核的工具提供了无缝集成。WSL 2 已经成为在 Windows 上进行 Linux 开发体验的新标准。  “WSL 2 从根本上改变了 Windows 上的 Linux 体验，它提供了一个真正的 Linux 内核，这意味着你可以在 Windows 上运行更多原生的 Linux 应用和工具。”   一、WSL 2 的核心：轻量级虚拟机与真实 Linux 内核1.1 与 WSL 1 的根本区别WSL 2 的核心在于采用了轻量级虚拟机 (VM) 的架构，而不是像 WSL 1 那样通过系统调用翻译层。    特性 WSL 1 WSL 2    底层架构 系统调用翻译层（无虚拟机） 基于 Hyper-V 的轻量级虚拟机，运行真实 Linux 内核   Linu...</div></div></div></a><a class="pagination-related" href="/2025/2025-01-12_Go%E8%AF%AD%E8%A8%80embed%E5%8C%85%E8%AF%A6%E8%A7%A3/" title="Go语言embed包详解"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-13.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-12</div><div class="info-item-2">Go语言embed包详解</div></div><div class="info-2"><div class="info-item-1"> Go 1.16 版本引入了 embed 包，它提供了一种将静态资源（如HTML、CSS、JavaScript、图片、配置文件等）直接嵌入 (embed) 到 Go 程序二进制文件中的功能。这极大地简化了应用程序的部署流程，尤其是对于需要捆绑前端资源或配置文件的后端服务。  “The embed package provides access to files embedded in the program during compilation.” —— Go embed 官方文档   一、为什么需要 embed 包？在 embed 包出现之前，Go 应用程序通常需要通过以下方式处理静态资源：  文件系统访问: 在运行时从文件系统加载资源。这意味着在部署时，除了可执行文件，还需要打包额外的资源文件。 go:generate 工具: 使用第三方工具（如 go-bindata、statik 等）将资源文件转换为 Go 源代码文件，然后在运行时加载这些生成的 Go 文件。这种方法引入了额外的构建步骤和依赖。  embed 包的出现，解决了上述痛点：  单一二进制文件: 应用程序和所有静...</div></div></div></a><a class="pagination-related" href="/2025/2025-01-18_Metasploit%20%E6%A1%86%E6%9E%B6%E8%AF%A6%E8%A7%A3/" title="Metasploit 框架详解"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-25.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-18</div><div class="info-item-2">Metasploit 框架详解</div></div><div class="info-2"><div class="info-item-1"> Metasploit 框架 是一个广为人知且功能强大的开源渗透测试工具。它提供了一个全面的平台，用于开发、测试和执行漏洞利用（exploit）。无论是安全研究人员、渗透测试工程师还是红队成员，Metasploit 都是他们工具箱中不可或缺的一部分。  核心思想：将漏洞利用、载荷生成、后渗透模块等功能模块化，提供统一的接口和工具链，简化复杂的渗透测试流程。   一、Metasploit 简介1.1 什么是 Metasploit？Metasploit 是由 Rapid7 公司维护的一个著名的开源项目。它是一个漏洞利用框架，旨在协助渗透测试人员识别、利用和验证漏洞。它不仅仅是一个简单的漏洞扫描器，更是一个提供多种工具和方法的集成环境，几乎覆盖了渗透测试的整个生命周期。 1.2 Metasploit 的发展历史 2003年：由 H.D. Moore 发起，最初是一个 Perl 语言的项目。 2004年：发布 2.0 版本，首次引入了模块化架构。 2007年：框架被重写，使用 Ruby 语言，提高了灵活性和可维护性。 209年：Rapid7 收购 Metasploit 项目，并继续其开发...</div></div></div></a><a class="pagination-related" href="/2025/2025-01-26_Msfvenom%20%E8%AF%A6%E8%A7%A3/" title="Msfvenom 详解"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-06.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-26</div><div class="info-item-2">Msfvenom 详解</div></div><div class="info-2"><div class="info-item-1"> Msfvenom 是 Metasploit 框架中的一个强大而独立的命令行工具，它结合了 msfpayload（载荷生成器）和 msfencode（编码器）的功能，旨在生成各种格式的恶意载荷（Payload）并对其进行编码，以规避安全检测。它是渗透测试人员和红队成员创建自定义后门和绕过防御机制的利器。  核心思想：将攻击载荷（Shellcode）和输出格式（如 EXE、ELF、ASPX 等）分离，允许用户自由组合并按需编码，生成高度定制化的恶意文件。   一、Msfvenom 简介1.1 什么是 Msfvenom？msfvenom 是一个命令行工具，属于 Metasploit Framework 的一部分。它的主要功能是：  载荷生成 (Payload Generation)：创建各种操作系统（Windows, Linux, macOS, Android 等）和架构（x86, x64 等）的恶意载荷。 编码 (Encoding)：对生成的载荷进行编码，以尝试绕过杀毒软件的签名检测或处理特殊字符（如 NUL \x00）。 格式化 (Formatting)：将生成的载荷输出为多种文...</div></div></div></a><a class="pagination-related" href="/2025/2025-01-27_Prometheus%E4%B8%8EGrafana%E8%AF%A6%E8%A7%A3%EF%BC%9A%E7%8E%B0%E4%BB%A3%E7%9B%91%E6%8E%A7%E7%9A%84%E9%BB%84%E9%87%91%E7%BB%84%E5%90%88/" title="Prometheus与Grafana详解：现代监控的黄金组合"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-10.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-27</div><div class="info-item-2">Prometheus与Grafana详解：现代监控的黄金组合</div></div><div class="info-2"><div class="info-item-1"> 在现代复杂的 IT 基础设施中，如何高效、准确地监控系统和应用的健康状况，并及时发现潜在问题，是运维和开发团队面临的巨大挑战。Prometheus 和 Grafana 正是为此而生的一对黄金搭档。Prometheus 负责数据的收集、存储和查询，而 Grafana 则负责数据的可视化和告警展示。它们共同构建了一个强大的开源监控解决方案，已成为云原生时代监控领域的事实标准。  “没有监控的系统就像在黑暗中航行的船只，随时可能触礁。”   一、Prometheus 详解1.1 Prometheus 是什么？Prometheus 是一个开源的时间序列数据库 (TSDB) 和监控系统，由 SoundCloud 公司开发并于 2016 年加入云原生计算基金会 (CNCF)，是其第二个毕业项目。它采用了一种拉取 (Pull) 模型来收集指标数据，并通过强大的多维度数据模型和灵活的查询语言 (PromQL) 来支持复杂的告警和分析。 1.2 Prometheus 的核心特点与优势 多维数据模型：所有指标都是以时间戳和键值对（称为标签或 labels）的形式存储的。例如，http_reques...</div></div></div></a><a class="pagination-related" href="/2025/2025-02-04_PromQL%E8%AF%A6%E8%A7%A3%EF%BC%9A%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Prometheus%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80/" title="PromQL详解：深入理解Prometheus查询语言"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-18.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-04</div><div class="info-item-2">PromQL详解：深入理解Prometheus查询语言</div></div><div class="info-2"><div class="info-item-1"> PromQL (Prometheus Query Language) 是 Prometheus 监控系统中用于查询、聚合和分析时间序列数据的一种功能强大的查询语言。它是 Prometheus 核心价值的体现之一。无论你是要构建仪表盘、创建告警规则，还是进行故障排查，PromQL 都是你与 Prometheus 数据进行交互的唯一途径。掌握 PromQL 是有效利用 Prometheus 的关键。  “PromQL 让你能够将原始指标数据转化为有意义的洞察和可操作的智能信息。”   一、Prometheus 指标类型回顾在深入 PromQL 之前，我们先快速回顾一下 Prometheus 的四种核心指标类型，因为 PromQL 的查询行为会根据指标类型有所不同：  Counter (计数器)：一种累计型指标，只增不减（重置除外）。通常用于统计请求总数、错误总数等。 例子：http_requests_total 适用 PromQL 函数：rate()、irate()、increase()   Gauge (测量仪)：一种可任意上下变动的指标，反映当前状态。通常用于表示内存使用量、C...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/loading.gif" data-lazy-src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">TeaTang</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">217</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">173</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">62</div></a></div><a id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/teatang"><i class="fab fa-github"></i><span>GitHub主页</span></a><div class="card-info-social-icons"><a class="social-icon" href="mailto:tea.tang1211@gmail.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">网站更多功能即将上线，敬请期待！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E8%99%9A%E6%8B%9F%E5%8C%96%E6%8A%80%E6%9C%AF%E6%A6%82%E8%BF%B0%E4%B8%8E-Hyper-V-%E7%9A%84%E5%AE%9A%E4%BD%8D"><span class="toc-text">一、虚拟化技术概述与 Hyper-V 的定位</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E4%BB%80%E4%B9%88%E6%98%AF%E8%99%9A%E6%8B%9F%E5%8C%96%EF%BC%9F"><span class="toc-text">1.1 什么是虚拟化？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E8%99%9A%E6%8B%9F%E5%8C%96%E7%B1%BB%E5%9E%8B%EF%BC%9AHyper-V-%E7%9A%84%E5%BD%92%E5%B1%9E"><span class="toc-text">1.2 虚拟化类型：Hyper-V 的归属</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-Hyper-V-%E7%9A%84%E4%BC%98%E5%8A%BF"><span class="toc-text">1.3 Hyper-V 的优势</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81Hyper-V-%E6%8A%80%E6%9C%AF%E6%9E%B6%E6%9E%84%E8%AF%A6%E8%A7%A3"><span class="toc-text">二、Hyper-V 技术架构详解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81Hyper-V-%E7%9A%84%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD"><span class="toc-text">三、Hyper-V 的核心功能</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81Hyper-V-%E7%9A%84%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86"><span class="toc-text">四、Hyper-V 的部署与管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-1-%E5%9C%A8-Windows-Server-%E4%B8%8A%E5%90%AF%E7%94%A8-Hyper-V"><span class="toc-text">4.1 1. 在 Windows Server 上启用 Hyper-V</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-2-%E5%9C%A8-Windows-%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%B8%8A%E5%90%AF%E7%94%A8-Hyper-V"><span class="toc-text">4.2 2. 在 Windows 客户端上启用 Hyper-V</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-3-%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7"><span class="toc-text">4.3 3. 管理工具</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81Hyper-V-%E7%9A%84%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7%E4%B8%8E%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-text">五、Hyper-V 的高级特性与应用场景</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-1-%E7%81%BE%E9%9A%BE%E6%81%A2%E5%A4%8D%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%80%A7"><span class="toc-text">5.1 1. 灾难恢复与高可用性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-2-%E5%A2%9E%E5%BC%BA%E4%BC%9A%E8%AF%9D%E6%A8%A1%E5%BC%8F-Enhanced-Session-Mode"><span class="toc-text">5.2 2. 增强会话模式 (Enhanced Session Mode)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-3-%E5%B5%8C%E5%A5%97%E8%99%9A%E6%8B%9F%E5%8C%96-Nested-Virtualization"><span class="toc-text">5.3 3. 嵌套虚拟化 (Nested Virtualization)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-4-Shielded-VMs-%E5%8F%97%E9%98%B2%E6%8A%A4%E7%9A%84%E8%99%9A%E6%8B%9F%E6%9C%BA"><span class="toc-text">5.4 4. Shielded VMs (受防护的虚拟机)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5-5-Linux-%E9%9B%86%E6%88%90%E6%9C%8D%E5%8A%A1"><span class="toc-text">5.5 5. Linux 集成服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-6-%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-text">5.6 6. 应用场景</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E4%B8%8E-VMware-vSphere-ESXi-%E7%9A%84%E6%AF%94%E8%BE%83"><span class="toc-text">六、与 VMware vSphere&#x2F;ESXi 的比较</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E6%80%BB%E7%BB%93"><span class="toc-text">七、总结</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/2025-10-28_nftables%20%E8%AF%A6%E8%A7%A3/" title="nftables 详解"><img src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-13.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="nftables 详解"/></a><div class="content"><a class="title" href="/2025/2025-10-28_nftables%20%E8%AF%A6%E8%A7%A3/" title="nftables 详解">nftables 详解</a><time datetime="2025-10-27T22:24:00.000Z" title="发表于 2025-10-28 06:24:00">2025-10-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/2025-10-25_iptables%20%E8%AF%A6%E8%A7%A3/" title="iptables 详解"><img src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-06.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="iptables 详解"/></a><div class="content"><a class="title" href="/2025/2025-10-25_iptables%20%E8%AF%A6%E8%A7%A3/" title="iptables 详解">iptables 详解</a><time datetime="2025-10-24T22:24:00.000Z" title="发表于 2025-10-25 06:24:00">2025-10-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/2025-10-23_Go%E8%AF%AD%E8%A8%80%E5%B9%B6%E5%8F%91%E4%B8%8E%E5%B9%B6%E8%A1%8C%E8%AF%A6%E8%A7%A3/" title="Go语言并发与并行详解"><img src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-05.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Go语言并发与并行详解"/></a><div class="content"><a class="title" href="/2025/2025-10-23_Go%E8%AF%AD%E8%A8%80%E5%B9%B6%E5%8F%91%E4%B8%8E%E5%B9%B6%E8%A1%8C%E8%AF%A6%E8%A7%A3/" title="Go语言并发与并行详解">Go语言并发与并行详解</a><time datetime="2025-10-22T22:24:00.000Z" title="发表于 2025-10-23 06:24:00">2025-10-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/2025-10-16_%E5%B8%B8%E7%94%A8%E9%99%90%E6%B5%81%E7%AE%97%E6%B3%95%E7%9A%84Go%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0%E8%AF%A6%E8%A7%A3/" title="常用限流算法的Go语言实现详解"><img src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-23.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="常用限流算法的Go语言实现详解"/></a><div class="content"><a class="title" href="/2025/2025-10-16_%E5%B8%B8%E7%94%A8%E9%99%90%E6%B5%81%E7%AE%97%E6%B3%95%E7%9A%84Go%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0%E8%AF%A6%E8%A7%A3/" title="常用限流算法的Go语言实现详解">常用限流算法的Go语言实现详解</a><time datetime="2025-10-15T22:24:00.000Z" title="发表于 2025-10-16 06:24:00">2025-10-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/2025-10-10_NativeScript-Vue3%E8%AF%A6%E8%A7%A3/" title="NativeScript-Vue3详解"><img src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-25.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="NativeScript-Vue3详解"/></a><div class="content"><a class="title" href="/2025/2025-10-10_NativeScript-Vue3%E8%AF%A6%E8%A7%A3/" title="NativeScript-Vue3详解">NativeScript-Vue3详解</a><time datetime="2025-10-09T22:24:00.000Z" title="发表于 2025-10-10 06:24:00">2025-10-10</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/cover/default_cover-18.jpg);"><div class="footer-flex"><div class="footer-flex-items"><div class="footer-flex-item"><div class="footer-flex-title">我的轨迹</div><div class="footer-flex-content"><a href="/archives/2023/" target="_blank" title="📌 2023">📌 2023</a><a href="/archives/2024/" target="_blank" title="❓ 2024">❓ 2024</a><a href="/archives/2025/" target="_blank" title="🚀 2025">🚀 2025</a></div></div></div><div class="footer-flex-items"><div class="footer-flex-item"><div class="footer-flex-title">维度</div><div class="footer-flex-content"><a href="/categories/" target="_blank" title="分类">分类</a><a href="/tags/" target="_blank" title="标签">标签</a><a href="/categories/" target="_blank" title="时间线">时间线</a></div></div></div><div class="footer-flex-items"><div class="footer-flex-item"><div class="footer-flex-title">其他</div><div class="footer-flex-content"><a href="/shuoshuo" target="_blank" title="说说">说说</a></div></div></div></div><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2021 - 2025 By TeaTang</span><span class="framework-info"><span class="footer-separator">|</span><span>框架 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.1"></script><script src="/js/main.js?v=5.5.1"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.0.33/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@19.1.3/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (true) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid@11.12.0/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>(() => {
  const applyThemeDefaultsConfig = theme => {
    if (theme === 'dark-mode') {
      Chart.defaults.color = "rgba(255, 255, 255, 0.8)"
      Chart.defaults.borderColor = "rgba(255, 255, 255, 0.2)"
      Chart.defaults.scale.ticks.backdropColor = "transparent"
    } else {
      Chart.defaults.color = "rgba(0, 0, 0, 0.8)"
      Chart.defaults.borderColor = "rgba(0, 0, 0, 0.1)"
      Chart.defaults.scale.ticks.backdropColor = "transparent"
    }
  }

  // Recursively traverse the config object and automatically apply theme-specific color schemes
  const applyThemeConfig = (obj, theme) => {
    if (typeof obj !== 'object' || obj === null) return

    Object.keys(obj).forEach(key => {
      const value = obj[key]
      // If the property is an object and has theme-specific options, apply them
      if (typeof value === 'object' && value !== null) {
        if (value[theme]) {
          obj[key] = value[theme] // Apply the value for the current theme
        } else {
          // Recursively process child objects
          applyThemeConfig(value, theme)
        }
      }
    })
  }

  const runChartJS = ele => {
    window.loadChartJS = true

    Array.from(ele).forEach((item, index) => {
      const chartSrc = item.firstElementChild
      const chartID = item.getAttribute('data-chartjs-id') || ('chartjs-' + index) // Use custom ID or default ID
      const width = item.getAttribute('data-width')
      const existingCanvas = document.getElementById(chartID)

      // If a canvas already exists, remove it to avoid rendering duplicates
      if (existingCanvas) {
          existingCanvas.parentNode.remove()
      }

      const chartDefinition = chartSrc.textContent
      const canvas = document.createElement('canvas')
      canvas.id = chartID

      const div = document.createElement('div')
      div.className = 'chartjs-wrap'

      if (width) {
        div.style.width = width
      }

      div.appendChild(canvas)
      chartSrc.insertAdjacentElement('afterend', div)

      const ctx = document.getElementById(chartID).getContext('2d')

      const config = JSON.parse(chartDefinition)

      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark-mode' : 'light-mode'

      // Set default styles (initial setup)
      applyThemeDefaultsConfig(theme)

      // Automatically traverse the config and apply dual-mode color schemes
      applyThemeConfig(config, theme)

      new Chart(ctx, config)
    })
  }

  const loadChartJS = () => {
    const chartJSEle = document.querySelectorAll('#article-container .chartjs-container')
    if (chartJSEle.length === 0) return

    window.loadChartJS ? runChartJS(chartJSEle) : btf.getScript('https://cdn.jsdelivr.net/npm/chart.js@4.5.0/dist/chart.umd.min.js').then(() => runChartJS(chartJSEle))
  }

  // Listen for theme change events
  btf.addGlobalFn('themeChange', loadChartJS, 'chartjs')
  btf.addGlobalFn('encrypt', loadChartJS, 'chartjs')

  window.pjax ? loadChartJS() : document.addEventListener('DOMContentLoaded', loadChartJS)
})()</script></div><script data-pjax src="/self/btf.js"></script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/fireworks.min.js"></script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="ture"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,200,200" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script>(() => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => {
      try {
        fn()
      } catch (err) {
        console.debug('Pjax callback failed:', err)
      }
    })
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      const usePjax = true
      true
        ? (usePjax ? pjax.loadUrl('/404.html') : window.location.href = '/404.html')
        : window.location.href = e.request.responseURL
    }
  })
})()</script><script>(() => {
  const option = null
  const config = {"site_uv":true,"site_pv":true,"page_pv":true,"token":"qTvz1SkmPDt785fgh6BpiA5qiFFIVUwxj8Ft+rPW+cdN59v1hXjwRgSmy0+ji9m+oLlcxvo2NfDSMa6epVl3NTlsN3ejCIwWeP8Y51aEJ0Sbem4UexGmJLspB7AkOBId2SdtT6QWEBlGmFIIQgchQ2zAKYxTmc/kpBED5aLSr+3uvmQ9/G7FJQeVFpveDkK0xM1hu36xq4a6/FSeROxtoEp5zabzTWiYTlLsQzIl/NlELnCq3nxK+oo/vl3UQo/oM/rae/gJX/MaVKsgIUCd2ABJogNkx2KTenBIBpbPki5FzOgPh6/z4GPa4HvhNO51DDVG1SEQZooqEYmt/gnybLBWFbN+7liZWw=="}

  const runTrack = () => {
    if (typeof umami !== 'undefined' && typeof umami.track === 'function') {
      umami.track(props => ({ ...props, url: window.location.pathname, title: GLOBAL_CONFIG_SITE.title }))
    } else {
      console.warn('Umami Analytics: umami.track is not available')
    }
  }

  const loadUmamiJS = () => {
    btf.getScript('https://umami.012700.xyz/script.js', {
      'data-website-id': '2a796d6c-6499-42d8-8eb4-d9a2930b0ff3',
      'data-auto-track': 'false',
      ...option
    }).then(() => {
      runTrack()
    }).catch(error => {
      console.error('Umami Analytics: Error loading script', error)
    })
  }

  const getData = async (isPost) => {
    try {
      const now = Date.now()
      const keyUrl = isPost ? `&url=${window.location.pathname}` : ''
      const headerList = { 'Accept': 'application/json' }

      if (true) {
        headerList['Authorization'] = `Bearer ${config.token}`
      } else {
        headerList['x-umami-api-key'] = config.token
      }

      const res = await fetch(`https://umami.012700.xyz/api/websites/2a796d6c-6499-42d8-8eb4-d9a2930b0ff3/stats?startAt=0000000000&endAt=${now}${keyUrl}`, {
        method: "GET",
        headers: headerList
      })

      if (!res.ok) {
        throw new Error(`HTTP error! status: ${res.status}`)
      }

      return await res.json()
    } catch (error) {
      console.error('Umami Analytics: Failed to fetch data', error)
      throw error
    }
  }

  const insertData = async () => {
    try {
      if (GLOBAL_CONFIG_SITE.pageType === 'post' && config.page_pv) {
        const pagePV = document.getElementById('umamiPV')
        if (pagePV) {
          const data = await getData(true)
          if (data && data.pageviews && typeof data.pageviews.value !== 'undefined') {
            pagePV.textContent = data.pageviews.value
          } else {
            console.warn('Umami Analytics: Invalid page view data received')
          }
        }
      }

      if (config.site_uv || config.site_pv) {
        const data = await getData(false)

        if (config.site_uv) {
          const siteUV = document.getElementById('umami-site-uv')
          if (siteUV && data && data.visitors && typeof data.visitors.value !== 'undefined') {
            siteUV.textContent = data.visitors.value
          } else if (siteUV) {
            console.warn('Umami Analytics: Invalid site UV data received')
          }
        }

        if (config.site_pv) {
          const sitePV = document.getElementById('umami-site-pv')
          if (sitePV && data && data.pageviews && typeof data.pageviews.value !== 'undefined') {
            sitePV.textContent = data.pageviews.value
          } else if (sitePV) {
            console.warn('Umami Analytics: Invalid site PV data received')
          }
        }
      }
    } catch (error) {
      console.error('Umami Analytics: Failed to insert data', error)
    }
  }

  btf.addGlobalFn('pjaxComplete', runTrack, 'umami_analytics_run_track')
  btf.addGlobalFn('pjaxComplete', insertData, 'umami_analytics_insert')


  loadUmamiJS()

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', insertData)
  } else {
    setTimeout(insertData, 100)
  }
})()</script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="local-search-input"><input placeholder="搜索文章" type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.5.1"></script></div></div></body></html>