<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>PowerShell 详解与使用技巧 | 1024 维度</title><meta name="author" content="TeaTang"><meta name="copyright" content="TeaTang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="PowerShell 是微软开发的一种命令行 shell 和脚本语言，专为系统管理和自动化设计。它基于 .NET Framework (Windows PowerShell) 或 .NET Core (PowerShell Core &#x2F; PowerShell 7+)，提供了比传统命令行工具（如 CMD 或 Bash）更强大、更统一且面向对象的管理体验。PowerShell 不仅限于 W">
<meta property="og:type" content="article">
<meta property="og:title" content="PowerShell 详解与使用技巧">
<meta property="og:url" content="https://blog.tbf1211.xx.kg/293e3d7e94ae/index.html">
<meta property="og:site_name" content="1024 维度">
<meta property="og:description" content="PowerShell 是微软开发的一种命令行 shell 和脚本语言，专为系统管理和自动化设计。它基于 .NET Framework (Windows PowerShell) 或 .NET Core (PowerShell Core &#x2F; PowerShell 7+)，提供了比传统命令行工具（如 CMD 或 Bash）更强大、更统一且面向对象的管理体验。PowerShell 不仅限于 W">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog.tbf1211.xx.kg/img/cover/default_cover-13.jpg">
<meta property="article:published_time" content="2025-08-19T22:24:00.000Z">
<meta property="article:modified_time" content="2026-01-14T08:21:35.578Z">
<meta property="article:author" content="TeaTang">
<meta property="article:tag" content="Shell">
<meta property="article:tag" content="Windows">
<meta property="article:tag" content="2025">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.tbf1211.xx.kg/img/cover/default_cover-13.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "PowerShell 详解与使用技巧",
  "url": "https://blog.tbf1211.xx.kg/293e3d7e94ae/",
  "image": "https://blog.tbf1211.xx.kg/img/cover/default_cover-13.jpg",
  "datePublished": "2025-08-19T22:24:00.000Z",
  "dateModified": "2026-01-14T08:21:35.578Z",
  "author": [
    {
      "@type": "Person",
      "name": "TeaTang",
      "url": "https://blog.tbf1211.xx.kg"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon-1.ico"><link rel="canonical" href="https://blog.tbf1211.xx.kg/293e3d7e94ae/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><meta name="google-site-verification" content="NdIUXAOVyGnnBhcrip0ksCawbdAzT0hlBZDE9u4jx6k"/><meta name="msvalidate.01" content="567E47D75E8DCF1282B9623AD914701E"/><meta name="baidu-site-verification" content="code-pE5rnuxcfD"/><link rel="stylesheet" href="/css/index.css?v=5.5.3"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1.7/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          const mediaQueryDark = window.matchMedia('(prefers-color-scheme: dark)')
          const mediaQueryLight = window.matchMedia('(prefers-color-scheme: light)')

          if (theme === undefined) {
            if (mediaQueryLight.matches) activateLightMode()
            else if (mediaQueryDark.matches) activateDarkMode()
            else {
              const hour = new Date().getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            mediaQueryDark.addEventListener('change', () => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else {
            theme === 'light' ? activateLightMode() : activateDarkMode()
          }
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.json","preload":false,"top_n_per_article":1,"unescape":false,"pagination":{"enable":true,"hitsPerPage":8},"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":400,"highlightFullpage":true,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":150,"languages":{"author":"作者: TeaTang","link":"链接: ","source":"来源: 1024 维度","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'PowerShell 详解与使用技巧',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="preconnect" href="https://jsd.012700.xyz"><link href="/self/btf.css" rel="stylesheet"><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="1024 维度" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/loading.gif" data-lazy-src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">493</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">225</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">83</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 我的轨迹</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/2023/"><i class="fa-fw fa-solid fa-bug"></i><span> 2023</span></a></li><li><a class="site-page child" href="/archives/2024/"><i class="fa-fw fa-solid fa-code"></i><span> 2024</span></a></li><li><a class="site-page child" href="/archives/2025/"><i class="fa-fw fa-solid fa-network-wired"></i><span> 2025</span></a></li><li><a class="site-page child" href="/archives/2026/"><i class="fa-fw fa-solid fa-code-branch"></i><span> 2026</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa-solid fa-calendar-days"></i><span> 时间线</span></a></div><div class="menus_item"><a class="site-page" href="/shuoshuo"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url(/img/cover/default_cover-13.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">1024 维度</span></a><a class="nav-page-title" href="/"><span class="site-name">PowerShell 详解与使用技巧</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 我的轨迹</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/2023/"><i class="fa-fw fa-solid fa-bug"></i><span> 2023</span></a></li><li><a class="site-page child" href="/archives/2024/"><i class="fa-fw fa-solid fa-code"></i><span> 2024</span></a></li><li><a class="site-page child" href="/archives/2025/"><i class="fa-fw fa-solid fa-network-wired"></i><span> 2025</span></a></li><li><a class="site-page child" href="/archives/2026/"><i class="fa-fw fa-solid fa-code-branch"></i><span> 2026</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa-solid fa-calendar-days"></i><span> 时间线</span></a></div><div class="menus_item"><a class="site-page" href="/shuoshuo"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">PowerShell 详解与使用技巧</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2025-08-19T22:24:00.000Z" title="发表于 2025-08-20 06:24:00">2025-08-20</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/">开发工具</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Windows/">Windows</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">3.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>13分钟</span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><blockquote>
<p><strong>PowerShell</strong> 是微软开发的一种<strong>命令行 shell 和脚本语言</strong>，专为系统管理和自动化设计。它基于 .NET Framework (Windows PowerShell) 或 .NET Core (PowerShell Core &#x2F; PowerShell 7+)，提供了比传统命令行工具（如 CMD 或 Bash）更强大、更统一且面向对象的管理体验。PowerShell 不仅限于 Windows 平台，现在已<strong>跨平台支持 Linux 和 macOS</strong>。</p>
</blockquote>
<div class="note info flat"><p>核心思想：<strong>“一切皆对象”</strong>。PowerShell 不像传统 shell 那样处理文本流，而是处理 .NET 对象。这意味着命令的输出可以直接作为另一个命令的输入，且数据类型和结构得以保留，极大地提升了脚本编写的效率和健壮性。</p>
</div>
<hr>
<h2 id="一、PowerShell-的起源与演进"><a href="#一、PowerShell-的起源与演进" class="headerlink" title="一、PowerShell 的起源与演进"></a>一、PowerShell 的起源与演进</h2><p>传统的 Windows 命令行工具（CMD）在自动化和复杂任务处理方面存在显著局限性，其主要问题是基于文本处理，使得数据解析和传递变得复杂且易出错。为了解决这些问题，微软开发了 PowerShell（最初名为 Monad），并于 2006 年发布。</p>
<h3 id="1-1-Windows-PowerShell-旧版"><a href="#1-1-Windows-PowerShell-旧版" class="headerlink" title="1.1 Windows PowerShell (旧版)"></a>1.1 Windows PowerShell (旧版)</h3><ul>
<li><strong>基于 .NET Framework</strong>：与 Windows 操作系统紧密集成，通常预装在 Windows 系统中。</li>
<li><strong>版本</strong>：从 1.0 到 5.1。Windows PowerShell 5.1 是最新且最后一个基于 .NET Framework 的版本，仍然广泛用于传统 Windows 环境。</li>
</ul>
<h3 id="1-2-PowerShell-Core-PowerShell-7-新版，推荐"><a href="#1-2-PowerShell-Core-PowerShell-7-新版，推荐" class="headerlink" title="1.2 PowerShell Core &#x2F; PowerShell 7+ (新版，推荐)"></a>1.2 PowerShell Core &#x2F; PowerShell 7+ (新版，推荐)</h3><ul>
<li><strong>基于 .NET Core &#x2F; .NET</strong>：实现了跨平台特性，支持 Windows、Linux 和 macOS。</li>
<li><strong>开源</strong>：PowerShell Core 是一个开源项目，积极迭代更新。</li>
<li><strong>版本</strong>：从 6.0 (PowerShell Core) 到当前的 PowerShell 7.x 系列。</li>
<li><strong>优势</strong>：<ul>
<li><strong>跨平台</strong>：统一了多操作系统下的管理体验。</li>
<li><strong>性能提升</strong>：得益于 .NET Core 的优化。</li>
<li><strong>新特性</strong>：持续引入新的 cmdlet 和语言功能。</li>
</ul>
</li>
</ul>
<p>本文后续将主要关注 PowerShell 7+ 及其核心概念。</p>
<h2 id="二、为什么选择-PowerShell？"><a href="#二、为什么选择-PowerShell？" class="headerlink" title="二、为什么选择 PowerShell？"></a>二、为什么选择 PowerShell？</h2><p>与传统的命令行工具和脚本语言相比，PowerShell 具有显著优势：</p>
<ol>
<li><strong>面向对象</strong>：这是 PowerShell 最核心的特性。命令输出的是对象，而不是纯文本。这意味着你可以直接访问对象的属性和方法，而无需进行复杂的文本解析。<ul>
<li><strong>示例 (传统 CMD)</strong>：<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dir</span> | <span class="built_in">findstr</span> &quot;txt&quot;</span><br></pre></td></tr></table></figure>
输出是文本，你需要用 <code>findstr</code> 等工具进行字符串匹配。</li>
<li><strong>示例 (PowerShell)</strong>：<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-ChildItem</span> | <span class="built_in">Where-Object</span> &#123;<span class="variable">$_</span>.Extension <span class="operator">-eq</span> <span class="string">&quot;.txt&quot;</span>&#125;</span><br></pre></td></tr></table></figure>
<code>Get-ChildItem</code> 输出的是文件和文件夹对象，你可以通过 <code>Where-Object</code> 直接筛选 <code>Extension</code> 属性。</li>
</ul>
</li>
<li><strong>强大的管道 (Pipeline)</strong>：利用管道 <code>|</code>，一个命令的输出对象可以无缝传递给下一个命令作为输入，实现复杂任务的链式处理。</li>
<li><strong>统一的管理接口</strong>：通过 PowerShell 的“提供程序 (Providers)”机制，你可以像操作文件系统一样操作注册表、证书存储、环境变量、活动目录等，极大地简化了系统管理。</li>
<li><strong>丰富的命令集 (Cmdlets)</strong>：PowerShell 提供了数千个预定义的 cmdlet，覆盖了文件系统、进程管理、网络、服务、事件日志等几乎所有系统管理领域。</li>
<li><strong>易学易用</strong>：遵循 <code>Verb-Noun</code> 的命名约定，使得 cmdlet 名称直观易懂（如 <code>Get-Process</code>、<code>Set-Service</code>）。内置的帮助系统也非常完善。</li>
<li><strong>强大的脚本能力</strong>：支持变量、循环、条件判断、函数、模块等高级编程特性，可以编写复杂的自动化脚本。</li>
<li><strong>远程管理</strong>：内置强大的远程执行能力，可以方便地管理远程 Windows、Linux 服务器。</li>
</ol>
<h2 id="三、PowerShell-核心概念详解"><a href="#三、PowerShell-核心概念详解" class="headerlink" title="三、PowerShell 核心概念详解"></a>三、PowerShell 核心概念详解</h2><h3 id="3-1-Cmdlet-Command-let"><a href="#3-1-Cmdlet-Command-let" class="headerlink" title="3.1 Cmdlet (Command-let)"></a>3.1 Cmdlet (Command-let)</h3><p><strong>定义</strong>：Cmdlet 是 PowerShell 命令行中的基本命令单元。它们通常由 C# 编写，并编译成 .NET 类。Cmdlet 的设计目标是执行单一、特定任务。</p>
<p><strong>命名约定</strong>：所有 cmdlet 都遵循 <code>Verb-Noun</code> 的命名约定，例如：</p>
<ul>
<li><code>Get-Process</code>：获取正在运行的进程。</li>
<li><code>Set-Service</code>：配置服务。</li>
<li><code>New-Item</code>：创建新项（文件、文件夹、注册表项等）。</li>
<li><code>Remove-Item</code>：删除项。</li>
</ul>
<p>这种命名方式使得命令更具可预测性，用户可以很容易地猜测命令的功能。</p>
<h3 id="3-2-对象-Objects"><a href="#3-2-对象-Objects" class="headerlink" title="3.2 对象 (Objects)"></a>3.2 对象 (Objects)</h3><p><strong>定义</strong>：在 PowerShell 中，命令的输出不是简单的文本字符串，而是结构化的 <strong>.NET 对象</strong>。每个对象都包含属性（Properties）和方法（Methods）。</p>
<p><strong>优势</strong>：</p>
<ul>
<li><strong>数据结构完整</strong>：输出数据保留了其原始的数据类型和结构，避免了文本解析的麻烦。</li>
<li><strong>易于操作</strong>：可以直接访问和操作对象的属性，进行筛选、排序和选择。</li>
</ul>
<p><strong>示例</strong>：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-Process</span> | <span class="built_in">Get-Member</span> <span class="literal">-MemberType</span> Property</span><br></pre></td></tr></table></figure>
<p><code>Get-Process</code> 命令会返回一系列 <code>System.Diagnostics.Process</code> 对象，每个对象都代表一个运行中的进程，包含诸如 <code>ProcessName</code>、<code>Id</code>、<code>CPU</code> 等属性。<code>Get-Member</code> 命令可以显示对象的属性和方法。</p>
<h3 id="3-3-管道-Pipeline"><a href="#3-3-管道-Pipeline" class="headerlink" title="3.3 管道 (Pipeline)"></a>3.3 管道 (Pipeline)</h3><p><strong>定义</strong>：管道是 PowerShell 中连接命令的核心机制，使用 <code>|</code> 符号表示。它允许一个 cmdlet 的输出对象直接作为下一个 cmdlet 的输入对象。</p>
<p><strong>工作原理</strong>：</p>
<ol>
<li>第一个命令执行并生成对象。</li>
<li>这些对象通过管道传递给第二个命令。</li>
<li>第二个命令接收这些对象作为输入，并对其进行处理，然后将处理结果（可能是新的对象或修改后的原对象）传递给下一个命令。</li>
</ol>
<p><strong>示例</strong>：<br>查找所有 CPU 使用率超过 50% 的进程，并按 CPU 使用率降序排列，然后只显示进程名和 ID：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-Process</span> |                 <span class="comment"># 获取所有进程对象</span></span><br><span class="line"><span class="built_in">Where-Object</span> &#123;<span class="variable">$_</span>.CPU <span class="operator">-gt</span> <span class="number">50</span>&#125; | <span class="comment"># 筛选 CPU 属性大于 50 的进程</span></span><br><span class="line"><span class="built_in">Sort-Object</span> <span class="literal">-Property</span> CPU <span class="literal">-Descending</span> | <span class="comment"># 按 CPU 属性降序排序</span></span><br><span class="line"><span class="built_in">Select-Object</span> <span class="literal">-Property</span> ProcessName,Id   <span class="comment"># 选择并只显示 ProcessName 和 Id 属性</span></span><br></pre></td></tr></table></figure>

<p><strong>管道流程图示</strong>：</p>
<div class="mermaid-wrap"><pre class="mermaid-src" data-config="{}" hidden>
    graph TD
    A[Get-Process] --&gt; B[&quot;Where-Object {$_.CPU -gt 50}&quot;]
    B --&gt; C[Sort-Object -Property CPU -Descending]
    C --&gt; D[Select-Object -Property ProcessName,Id]
  </pre></div>

<h3 id="3-4-提供程序-Providers"><a href="#3-4-提供程序-Providers" class="headerlink" title="3.4 提供程序 (Providers)"></a>3.4 提供程序 (Providers)</h3><p><strong>定义</strong>：PowerShell 提供程序允许你以统一的方式（如同文件系统路径一样）访问和管理不同类型的数据存储。</p>
<p><strong>常见提供程序</strong>：</p>
<ul>
<li><code>FileSystem</code>：访问文件和目录。</li>
<li><code>Registry</code>：访问 Windows 注册表。</li>
<li><code>Alias</code>：访问 PowerShell 别名。</li>
<li><code>Variable</code>：访问 PowerShell 变量。</li>
<li><code>Certificate</code>：访问证书存储。</li>
<li><code>Environment</code>：访问环境变量。</li>
</ul>
<p><strong>示例</strong>：</p>
<ul>
<li>查看注册表 <code>HKLM:\SOFTWARE</code> 下的内容：<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-ChildItem</span> HKLM:\SOFTWARE</span><br></pre></td></tr></table></figure></li>
<li>进入环境变量路径，查看所有环境变量：<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Set-Location</span> Env:</span><br><span class="line"><span class="built_in">Get-ChildItem</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="3-5-模块-Modules"><a href="#3-5-模块-Modules" class="headerlink" title="3.5 模块 (Modules)"></a>3.5 模块 (Modules)</h3><p><strong>定义</strong>：模块是组织和分发 PowerShell 代码的方式。它们包含 cmdlet、函数、变量和其他资源，可以导入到 PowerShell 会话中以扩展功能。</p>
<p><strong>常见操作</strong>：</p>
<ul>
<li><code>Get-Module</code>：列出当前会话中已加载或可用的模块。</li>
<li><code>Import-Module</code>：导入特定模块。</li>
<li><code>Remove-Module</code>：移除模块。</li>
</ul>
<p><strong>示例</strong>：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-Module</span> <span class="literal">-ListAvailable</span> <span class="comment"># 列出所有可用的模块</span></span><br><span class="line"><span class="built_in">Import-Module</span> <span class="literal">-Name</span> Az.Accounts <span class="comment"># 导入 Azure PowerShell 模块的一个组件</span></span><br></pre></td></tr></table></figure>

<h2 id="四、PowerShell-基本使用与常见-Cmdlet"><a href="#四、PowerShell-基本使用与常见-Cmdlet" class="headerlink" title="四、PowerShell 基本使用与常见 Cmdlet"></a>四、PowerShell 基本使用与常见 Cmdlet</h2><h3 id="4-1-获取帮助"><a href="#4-1-获取帮助" class="headerlink" title="4.1 获取帮助"></a>4.1 获取帮助</h3><ul>
<li><strong><code>Get-Help &lt;CmdletName&gt;</code></strong>：获取指定 cmdlet 的详细帮助信息。</li>
<li><strong><code>Get-Help &lt;CmdletName&gt; -Full</code></strong>：获取完整帮助，包括参数、示例和相关链接。</li>
<li><strong><code>Get-Help &lt;CmdletName&gt; -Examples</code></strong>：只显示示例。</li>
<li><strong><code>Update-Help</code></strong>：首次使用时，更新本地的帮助文件，以获取最新帮助文档。</li>
</ul>
<h3 id="4-2-文件和目录管理"><a href="#4-2-文件和目录管理" class="headerlink" title="4.2 文件和目录管理"></a>4.2 文件和目录管理</h3><ul>
<li><strong><code>Get-ChildItem</code> (别名 <code>ls</code>, <code>dir</code>)</strong>：获取文件和文件夹。<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-ChildItem</span> <span class="literal">-Path</span> C:\Users\YourUser <span class="operator">-File</span> <span class="literal">-Recurse</span> <span class="literal">-Filter</span> <span class="string">&quot;*.log&quot;</span></span><br></pre></td></tr></table></figure></li>
<li><strong><code>New-Item</code></strong>：创建文件或文件夹。<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">New-Item</span> <span class="literal">-Path</span> C:\Temp\MyFolder <span class="literal">-ItemType</span> Directory</span><br><span class="line"><span class="built_in">New-Item</span> <span class="literal">-Path</span> C:\Temp\MyFile.txt <span class="literal">-ItemType</span> File <span class="literal">-Value</span> <span class="string">&quot;Hello, PowerShell!&quot;</span></span><br></pre></td></tr></table></figure></li>
<li><strong><code>Remove-Item</code> (别名 <code>del</code>, <code>rm</code>)</strong>：删除文件或文件夹。<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Remove-Item</span> <span class="literal">-Path</span> C:\Temp\MyFile.txt</span><br><span class="line"><span class="built_in">Remove-Item</span> <span class="literal">-Path</span> C:\Temp\MyFolder <span class="literal">-Recurse</span> <span class="literal">-Force</span> <span class="comment"># 强制递归删除文件夹及其内容</span></span><br></pre></td></tr></table></figure></li>
<li><strong><code>Move-Item</code> (别名 <code>mv</code>)</strong>：移动文件或文件夹。<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Move-Item</span> <span class="literal">-Path</span> C:\Temp\MyFile.txt <span class="literal">-Destination</span> C:\NewLocation\</span><br></pre></td></tr></table></figure></li>
<li><strong><code>Copy-Item</code> (别名 <code>cp</code>)</strong>：复制文件或文件夹。<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Copy-Item</span> <span class="literal">-Path</span> C:\Temp\MyFile.txt <span class="literal">-Destination</span> C:\Backup\</span><br></pre></td></tr></table></figure></li>
<li><strong><code>Get-Content</code> (别名 <code>cat</code>, <code>type</code>)</strong>：获取文件内容。<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-Content</span> <span class="literal">-Path</span> C:\Temp\MyFile.txt</span><br></pre></td></tr></table></figure></li>
<li><strong><code>Set-Content</code></strong>：设置或覆盖文件内容。<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Set-Content</span> <span class="literal">-Path</span> C:\Temp\MyFile.txt <span class="literal">-Value</span> <span class="string">&quot;New content.&quot;</span></span><br></pre></td></tr></table></figure></li>
<li><strong><code>Add-Content</code></strong>：向文件追加内容。<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Add-Content</span> <span class="literal">-Path</span> C:\Temp\MyFile.txt <span class="literal">-Value</span> <span class="string">&quot;`nAppended line.&quot;</span> <span class="comment"># `n 是换行符</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="4-3-进程和服务管理"><a href="#4-3-进程和服务管理" class="headerlink" title="4.3 进程和服务管理"></a>4.3 进程和服务管理</h3><ul>
<li><strong><code>Get-Process</code> (别名 <code>ps</code>)</strong>：获取正在运行的进程。<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-Process</span> <span class="literal">-Name</span> chrome,firefox | <span class="built_in">Select-Object</span> <span class="literal">-Property</span> Id,ProcessName,CPU,WorkingSet</span><br></pre></td></tr></table></figure></li>
<li><strong><code>Stop-Process</code></strong>：停止进程。<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Stop-Process</span> <span class="literal">-Name</span> <span class="string">&quot;notepad&quot;</span></span><br><span class="line"><span class="built_in">Stop-Process</span> <span class="literal">-Id</span> <span class="number">1234</span> <span class="literal">-Force</span> <span class="comment"># 强制停止</span></span><br></pre></td></tr></table></figure></li>
<li><strong><code>Get-Service</code></strong>：获取服务信息。<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-Service</span> <span class="literal">-Name</span> wuauserv | <span class="built_in">Select-Object</span> <span class="literal">-Property</span> Name,Status,DisplayName</span><br></pre></td></tr></table></figure></li>
<li><strong><code>Start-Service</code></strong>：启动服务。<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Start-Service -Name wuauserv</span><br></pre></td></tr></table></figure></li>
<li><strong><code>Stop-Service</code></strong>：停止服务。<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Stop-Service</span> <span class="literal">-Name</span> wuauserv</span><br></pre></td></tr></table></figure></li>
<li><strong><code>Restart-Service</code></strong>：重启服务。<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Restart-Service</span> <span class="literal">-Name</span> wuauserv</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="4-4-数据筛选、排序与格式化"><a href="#4-4-数据筛选、排序与格式化" class="headerlink" title="4.4 数据筛选、排序与格式化"></a>4.4 数据筛选、排序与格式化</h3><ul>
<li><strong><code>Where-Object</code> (别名 <code>where</code>)</strong>：筛选对象。<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-Process</span> | <span class="built_in">Where-Object</span> &#123;<span class="variable">$_</span>.CPU <span class="operator">-gt</span> <span class="number">50</span> <span class="operator">-and</span> <span class="variable">$_</span>.ProcessName <span class="operator">-notlike</span> <span class="string">&quot;Idle&quot;</span>&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>$_</code> 代表当前管道中的对象。</li>
<li><code>-eq</code> 等于, <code>-ne</code> 不等于, <code>-gt</code> 大于, <code>-ge</code> 大于等于, <code>-lt</code> 小于, <code>-le</code> 小于等于</li>
<li><code>-like</code> 字符串模式匹配 (通配符 <code>*</code>)</li>
<li><code>-notlike</code> 非模式匹配</li>
<li><code>-match</code> 正则表达式匹配</li>
<li><code>-notmatch</code> 非正则表达式匹配</li>
<li><code>-contains</code> 集合包含</li>
<li><code>-notcontains</code> 集合不包含</li>
<li><code>-in</code> 在集合中</li>
<li><code>-notin</code> 不在集合中</li>
</ul>
</li>
<li><strong><code>Sort-Object</code> (别名 <code>sort</code>)</strong>：对对象进行排序。<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-Service</span> | <span class="built_in">Sort-Object</span> <span class="literal">-Property</span> Status,Name <span class="literal">-Descending</span></span><br></pre></td></tr></table></figure></li>
<li><strong><code>Select-Object</code> (别名 <code>select</code>)</strong>：选择对象的特定属性。<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-EventLog</span> <span class="literal">-LogName</span> System <span class="literal">-Newest</span> <span class="number">10</span> | <span class="built_in">Select-Object</span> <span class="literal">-Property</span> TimeGenerated,Source,Message</span><br></pre></td></tr></table></figure></li>
<li><strong><code>Format-Table</code> (别名 <code>ft</code>)</strong>：将对象格式化为表格。<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-Process</span> | <span class="built_in">Select-Object</span> <span class="literal">-First</span> <span class="number">5</span> | <span class="built_in">Format-Table</span> <span class="literal">-AutoSize</span></span><br></pre></td></tr></table></figure></li>
<li><strong><code>Format-List</code> (别名 <code>fl</code>)</strong>：将对象格式化为列表，显示所有属性。<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-Process</span> <span class="literal">-Name</span> <span class="string">&quot;powershell&quot;</span> | <span class="built_in">Format-List</span> <span class="literal">-Property</span> *</span><br></pre></td></tr></table></figure></li>
<li><strong><code>ConvertTo-Json</code> &#x2F; <code>ConvertFrom-Json</code></strong>：转换为 JSON &#x2F; 从 JSON 转换。</li>
<li><strong><code>ConvertTo-Csv</code> &#x2F; <code>Import-Csv</code> &#x2F; <code>Export-Csv</code></strong>：处理 CSV 文件。</li>
</ul>
<h2 id="五、PowerShell-脚本编程"><a href="#五、PowerShell-脚本编程" class="headerlink" title="五、PowerShell 脚本编程"></a>五、PowerShell 脚本编程</h2><p>PowerShell 是一种功能齐全的脚本语言，支持变量、控制流、函数等。</p>
<h3 id="5-1-变量"><a href="#5-1-变量" class="headerlink" title="5.1 变量"></a>5.1 变量</h3><ul>
<li>使用 <code>$</code> 符号定义变量。<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$myString</span> = <span class="string">&quot;Hello, World!&quot;</span></span><br><span class="line"><span class="variable">$myNumber</span> = <span class="number">123</span></span><br><span class="line"><span class="variable">$myArray</span> = <span class="selector-tag">@</span>(<span class="string">&quot;apple&quot;</span>, <span class="string">&quot;banana&quot;</span>, <span class="string">&quot;cherry&quot;</span>)</span><br><span class="line"><span class="variable">$myHash</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;Name&quot;</span> = <span class="string">&quot;Alice&quot;</span>; <span class="string">&quot;Age&quot;</span> = <span class="number">30</span>&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="5-2-条件语句-If-ElseIf-Else"><a href="#5-2-条件语句-If-ElseIf-Else" class="headerlink" title="5.2 条件语句 (If-ElseIf-Else)"></a>5.2 条件语句 (<code>If-ElseIf-Else</code>)</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$score</span> = <span class="number">85</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$score</span> <span class="operator">-ge</span> <span class="number">90</span>) &#123;</span><br><span class="line">    <span class="built_in">Write-Host</span> <span class="string">&quot;A&quot;</span></span><br><span class="line">&#125; <span class="keyword">elseif</span> (<span class="variable">$score</span> <span class="operator">-ge</span> <span class="number">80</span>) &#123;</span><br><span class="line">    <span class="built_in">Write-Host</span> <span class="string">&quot;B&quot;</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">Write-Host</span> <span class="string">&quot;C&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-3-循环语句"><a href="#5-3-循环语句" class="headerlink" title="5.3 循环语句"></a>5.3 循环语句</h3><ul>
<li><strong><code>ForEach</code> 循环</strong>：<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$numbers</span> = <span class="selector-tag">@</span>(<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>)</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$num</span> <span class="keyword">in</span> <span class="variable">$numbers</span>) &#123;</span><br><span class="line">    <span class="built_in">Write-Host</span> <span class="string">&quot;Number is: <span class="variable">$num</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 管道中的 ForEach-Object (别名 %)</span></span><br><span class="line"><span class="number">1</span>..<span class="number">5</span> | <span class="built_in">ForEach-Object</span> &#123;</span><br><span class="line">    <span class="string">&quot;Processing <span class="variable">$_</span>&quot;</span> <span class="comment"># $_ 代表当前管道中的元素</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><strong><code>For</code> 循环</strong>：<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="number">5</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">    <span class="built_in">Write-Host</span> <span class="string">&quot;Iteration: <span class="variable">$i</span>&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><strong><code>While</code> 循环</strong>：<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$count</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> (<span class="variable">$count</span> <span class="operator">-lt</span> <span class="number">3</span>) &#123;</span><br><span class="line">    <span class="built_in">Write-Host</span> <span class="string">&quot;Count: <span class="variable">$count</span>&quot;</span></span><br><span class="line">    <span class="variable">$count</span>++</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="5-4-函数"><a href="#5-4-函数" class="headerlink" title="5.4 函数"></a>5.4 函数</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Get-MyCurrentPath</span></span> &#123;</span><br><span class="line">    <span class="keyword">param</span> (</span><br><span class="line">        [<span class="built_in">string</span>]<span class="variable">$Path</span> = (<span class="built_in">Get-Location</span>).Path <span class="comment"># 定义一个带默认值的参数</span></span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">Write-Host</span> <span class="string">&quot;Current path is: <span class="variable">$Path</span>&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$Path</span> <span class="comment"># 函数可以返回值</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Get-MyCurrentPath</span></span><br><span class="line"><span class="built_in">Get-MyCurrentPath</span> <span class="literal">-Path</span> <span class="string">&quot;C:\Windows&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="5-5-错误处理-Try-Catch-Finally"><a href="#5-5-错误处理-Try-Catch-Finally" class="headerlink" title="5.5 错误处理 (Try-Catch-Finally)"></a>5.5 错误处理 (<code>Try-Catch-Finally</code>)</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment"># 尝试执行可能出错的代码</span></span><br><span class="line">    <span class="built_in">Get-Item</span> <span class="literal">-Path</span> <span class="string">&quot;NonExistentFile.txt&quot;</span> <span class="literal">-ErrorAction</span> Stop <span class="comment"># ErrorAction Stop 会将错误转换为终止错误</span></span><br><span class="line">    <span class="built_in">Write-Host</span> <span class="string">&quot;This line will not execute if an error occurs.&quot;</span></span><br><span class="line">&#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">    <span class="comment"># 捕获并处理错误</span></span><br><span class="line">    <span class="built_in">Write-Host</span> <span class="string">&quot;An error occurred: <span class="variable">$</span>(<span class="variable">$_</span>.Exception.Message)&quot;</span></span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    <span class="comment"># 无论是否发生错误，都会执行的代码</span></span><br><span class="line">    <span class="built_in">Write-Host</span> <span class="string">&quot;Error handling block finished.&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-6-PowerShell-脚本示例"><a href="#5-6-PowerShell-脚本示例" class="headerlink" title="5.6 PowerShell 脚本示例"></a>5.6 PowerShell 脚本示例</h3><p>以下是一个简单的 PowerShell 脚本，用于获取并显示系统中所有正在运行的服务，并按名称排序，然后将状态为“正在运行”的服务写入日志文件。</p>
<p><code>Get-RunningServices.ps1</code></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义日志文件路径</span></span><br><span class="line"><span class="variable">$logFilePath</span> = <span class="string">&quot;C:\Temp\RunningServices.log&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 确保日志目录存在</span></span><br><span class="line"><span class="keyword">if</span> (<span class="operator">-not</span> (<span class="built_in">Test-Path</span> (<span class="built_in">Split-Path</span> <span class="variable">$logFilePath</span>))) &#123;</span><br><span class="line">    <span class="built_in">New-Item</span> <span class="literal">-ItemType</span> Directory <span class="literal">-Path</span> (<span class="built_in">Split-Path</span> <span class="variable">$logFilePath</span>) | <span class="built_in">Out-Null</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取所有服务，筛选出正在运行的服务，按名称排序</span></span><br><span class="line"><span class="variable">$runningServices</span> = <span class="built_in">Get-Service</span> |</span><br><span class="line">                   <span class="built_in">Where-Object</span> &#123;<span class="variable">$_</span>.Status <span class="operator">-eq</span> <span class="string">&quot;Running&quot;</span>&#125; |</span><br><span class="line">                   <span class="built_in">Sort-Object</span> <span class="literal">-Property</span> Name |</span><br><span class="line">                   <span class="built_in">Select-Object</span> <span class="literal">-Property</span> Name,DisplayName,Status,StartType</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出到控制台</span></span><br><span class="line"><span class="built_in">Write-Host</span> <span class="string">&quot;--- 正在运行的服务清单 ---&quot;</span></span><br><span class="line"><span class="variable">$runningServices</span> | <span class="built_in">Format-Table</span> <span class="literal">-AutoSize</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将结果写入日志文件</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="variable">$currentTime</span> = <span class="built_in">Get-Date</span> <span class="literal">-Format</span> <span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span></span><br><span class="line">    <span class="built_in">Add-Content</span> <span class="literal">-Path</span> <span class="variable">$logFilePath</span> <span class="literal">-Value</span> (<span class="string">&quot;`n--- 服务状态报告: &#123;0&#125; ---`n&quot;</span> <span class="operator">-f</span> <span class="variable">$currentTime</span>)</span><br><span class="line">    <span class="variable">$runningServices</span> | <span class="built_in">Out-String</span> | <span class="built_in">Add-Content</span> <span class="literal">-Path</span> <span class="variable">$logFilePath</span></span><br><span class="line">    <span class="built_in">Write-Host</span> <span class="string">&quot;`n服务清单已成功写入日志文件: <span class="variable">$logFilePath</span>&quot;</span> <span class="literal">-ForegroundColor</span> Green</span><br><span class="line">&#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">    <span class="built_in">Write-Host</span> <span class="string">&quot;`n写入日志文件时发生错误: <span class="variable">$</span>(<span class="variable">$_</span>.Exception.Message)&quot;</span> <span class="literal">-ForegroundColor</span> Red</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Write-Host</span> <span class="string">&quot;--------------------------&quot;</span></span><br></pre></td></tr></table></figure>

<p><strong>执行脚本</strong>：</p>
<ol>
<li>保存为 <code>.ps1</code> 文件。</li>
<li>在 PowerShell 中运行：<code>.\Get-RunningServices.ps1</code></li>
<li>如果遇到执行策略问题，可能需要更改执行策略：<code>Set-ExecutionPolicy RemoteSigned -Scope CurrentUser</code> (仅限当前用户允许运行签名脚本和本地脚本)。</li>
</ol>
<h2 id="六、高级特性-简述"><a href="#六、高级特性-简述" class="headerlink" title="六、高级特性 (简述)"></a>六、高级特性 (简述)</h2><ul>
<li><strong>远程管理</strong>：使用 <code>Invoke-Command</code> 在远程计算机上执行脚本或命令。</li>
<li><strong>Desired State Configuration (DSC)</strong>：一种配置管理平台，用于定义和部署服务器的期望状态。</li>
<li><strong>Classes 和 Enums</strong>：PowerShell 5.0+ 引入了面向对象编程的类和枚举支持。</li>
<li><strong>后台作业 (Jobs)</strong>：使用 <code>Start-Job</code> 在后台运行命令或脚本。</li>
<li><strong>事件日志管理</strong>：<code>Get-WinEvent</code> &#x2F; <code>Get-EventLog</code>。</li>
<li><strong>网络操作</strong>：<code>Invoke-WebRequest</code> (别名 <code>wget</code>, <code>curl</code>) 用于 HTTP 请求。</li>
</ul>
<h2 id="七、开发环境与工具"><a href="#七、开发环境与工具" class="headerlink" title="七、开发环境与工具"></a>七、开发环境与工具</h2><ol>
<li><strong>PowerShell 控制台</strong>：基本的命令行界面。</li>
<li><strong>PowerShell ISE (Integrated Scripting Environment)</strong>：Windows 上的经典 PowerShell IDE，提供语法高亮、自动补全、调试器等。</li>
<li><strong>Visual Studio Code (VS Code)</strong>：推荐的跨平台 PowerShell 开发环境。安装 <strong>PowerShell 扩展</strong>后，VS Code 提供了卓越的脚本编辑、调试、智能提示和集成终端体验。</li>
</ol>
<h2 id="八、安全性考虑"><a href="#八、安全性考虑" class="headerlink" title="八、安全性考虑"></a>八、安全性考虑</h2><ol>
<li><strong>执行策略 (Execution Policy)</strong>：PowerShell 的安全功能，用于控制哪些脚本可以运行。<ul>
<li><code>Get-ExecutionPolicy</code>：查看当前策略。</li>
<li><code>Set-ExecutionPolicy</code>：设置策略。</li>
<li><strong>策略类型</strong>：<ul>
<li><code>Restricted</code>：默认策略，不允许任何脚本运行。</li>
<li><code>AllSigned</code>：只允许运行由受信任的发布者签名的脚本。</li>
<li><code>RemoteSigned</code>：允许本地创建的脚本运行，但从互联网下载的脚本必须签名。</li>
<li><code>Unrestricted</code>：允许所有脚本运行 (不推荐)。</li>
<li><code>Bypass</code>：无任何限制或警告 (仅限自动化工具使用)。</li>
</ul>
</li>
</ul>
</li>
<li><strong>凭据管理</strong>：避免在脚本中硬编码敏感信息。使用 <code>Get-Credential</code> 获取凭据对象，或集成密码管理解决方案。</li>
<li><strong>日志记录</strong>：记录脚本的执行活动和结果，便于审计和故障排除。</li>
<li><strong>最小权限原则</strong>：运行 PowerShell 脚本时，确保使用具有所需最低权限的账户。</li>
</ol>
<h2 id="九、总结"><a href="#九、总结" class="headerlink" title="九、总结"></a>九、总结</h2><p>PowerShell 凭借其面向对象的特性、强大的管道机制和跨平台能力，已经成为现代系统管理和自动化的核心工具。无论是管理 Windows 服务器、Azure 云资源，还是在 Linux 和 macOS 环境中进行自动化操作，PowerShell 都能提供统一、高效且功能丰富的解决方案。掌握 PowerShell 能够显著提升IT专业人员和开发者的工作效率，是现代IT技能栈中不可或缺的一部分。深入理解其核心概念并结合实践，将使您能够构建出强大而健壮的自动化脚本。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://blog.tbf1211.xx.kg">TeaTang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://blog.tbf1211.xx.kg/293e3d7e94ae/">https://blog.tbf1211.xx.kg/293e3d7e94ae/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://blog.tbf1211.xx.kg" target="_blank">1024 维度</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Shell/">Shell</a><a class="post-meta__tags" href="/tags/Windows/">Windows</a><a class="post-meta__tags" href="/tags/2025/">2025</a></div><div class="post-share"><div class="social-share" data-image="/img/cover/default_cover-13.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/3137f8a10771/" title="Chocolatey (Choco) 详解：Windows 上的包管理器"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-20.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Chocolatey (Choco) 详解：Windows 上的包管理器</div></div><div class="info-2"><div class="info-item-1"> Chocolatey 是 Windows 平台上的一个开源包管理器，它简化了软件的安装、升级、配置和卸载过程。类似于 Linux 上的 apt 或 yum，以及 macOS 上的 Homebrew，Chocolatey 允许用户通过命令行快速、自动化地管理 Windows 应用程序和工具，极大地提高了开发人员和系统管理员的工作效率。  核心思想：将 Windows 软件的安装、升级、管理过程标准化和自动化，通过命令行实现“一键安装”，摆脱手动下载、点击下一步的繁琐。   一、为什么需要 Chocolatey？传统的 Windows 软件安装方式存在诸多不便：  手动下载：需要访问各个软件的官方网站，查找下载链接。 点击下一步：安装过程通常需要反复点击“下一步”、“同意协议”，耗时且乏味。 升级繁琐：软件升级也需要重复上述步骤，或依赖软件自带的升级器，管理不集中。 依赖管理：某些软件可能依赖于其他运行时环境或库，手动安装容易出错或遗漏。 自动化部署困难：对于需要批量部署软件的企业或自动化环境，手动安装是巨大的障碍。  Chocolatey 旨在解决这些问题，提供以下优势：  自动...</div></div></div></a><a class="pagination-related" href="/4d6633389932/" title="中国婴儿疫苗选择详解：免疫规划与非免疫规划疫苗对比分析"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-29.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">中国婴儿疫苗选择详解：免疫规划与非免疫规划疫苗对比分析</div></div><div class="info-2"><div class="info-item-1"> 疫苗接种是预防和控制传染病最经济、最有效、最安全的手段。在中国，婴儿的疫苗接种遵循国家统一的免疫规划，并在此基础上，家长可以根据自身情况和儿科医生的建议，选择接种部分非强制性疫苗以提供更全面的保护。本文旨在详细介绍中国婴儿疫苗的分类、接种策略，并对主要疫苗进行对比说明，帮助家长做出明智的决策。  重要提示：本文提供的信息仅用于科普和参考，不能替代专业的医疗建议。每位婴儿的健康状况和地区流行病学特点不同，具体的疫苗选择和接种方案务必咨询当地正规医疗机构的儿科医生或预防接种医生。    一、中国婴儿疫苗的分类与接种原则根据中国《疫苗管理法》和《中华人民共和国传染病防治法》的规定，疫苗分为两类： 1.1 一类疫苗 (国家免疫规划疫苗) 定义：指政府免费向公民提供，公民应当依照政府的规定接种的疫苗。 特点：强制性，免费。主要针对在人群中危害大、发病率高、易引起暴发流行的传染病。 资金来源：由国家财政承担。 目标：构建群体免疫屏障，保障儿童公共健康。  1.2 二类疫苗 (非免疫规划疫苗) 定义：指公民自愿接种，由公民或其监护人承担费用的疫苗。 特点：自愿性，自费。种类繁多，可对一类疫苗...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2214744a8ff3/" title="Oh My Posh 详解 - 终端提示符美化与增强"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-31.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-29</div><div class="info-item-2">Oh My Posh 详解 - 终端提示符美化与增强</div></div><div class="info-2"><div class="info-item-1"> Oh My Posh 是一个开源的、高度可定制的命令行提示符（prompt）引擎，旨在为你的终端（Terminal）提供美观且功能丰富的提示符。它支持多种 shell，包括 PowerShell、Bash、Zsh、Cmd、Fish 等，并且能够显示 Git 状态、当前路径、用户名、系统信息、电池状态等多种上下文信息，极大地提升了终端使用的效率和体验。  核心思想：将静态、单调的命令行提示符，转换为动态、数据丰富、高度定制化且视觉友好的信息中心，从而提高工作效率和终端美观度。   一、为什么选择 Oh My Posh？传统的命令行提示符通常信息量有限且外观单调，例如 PS C:\Users\Username&gt; 或 user@host:~$。在进行复杂的开发工作时，你可能经常需要：  查看 Git 仓库状态：当前分支、是否有未提交的更改、是否有未推送的提交。 快速了解当前路径：路径过长时自动截断，仅显示相关部分。 获取其他上下文信息：例如当前 Python 虚拟环境、Node.js 版本、Go 版本、电池电量等。 视觉美观：一个漂亮的终端能让人心情愉悦，提高工作效率。 跨平台...</div></div></div></a><a class="pagination-related" href="/5f4f405cbb7a/" title="Scoop (Windows 命令行包管理器) 详解"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-19.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-23</div><div class="info-item-2">Scoop (Windows 命令行包管理器) 详解</div></div><div class="info-2"><div class="info-item-1"> Scoop 是 Windows 平台上的一个开源命令行安装程序，它旨在为开发者提供一个简洁、无需管理员权限、便携式的软件管理解决方案。与传统的 Windows 软件安装方式不同，Scoop 不会污染系统 PATH，不依赖 MSI 安装程序，并且默认将软件安装到用户目录而非系统目录。它特别适合于管理开发工具、CLI 应用程序以及其他便携式软件。  核心思想：为 Windows 用户提供一种无需管理员权限、以用户级别安装和管理软件的方式，强调简洁、便携和避免系统污染。   一、为什么选择 Scoop？传统的 Windows 软件安装和管理方式存在以下痛点：  管理员权限 (UAC 提示)：大多数 Windows 软件安装都需要管理员权限，频繁弹出 UAC (User Account Control) 提示，打断工作流。 系统路径污染 (PATH)：许多软件会将自身目录添加到系统 PATH 环境变量中，随着安装的软件增多，PATH 变得冗长且难以管理。 非便携式安装：多数软件通过 MSI 或 EXE 安装程序进行安装，会将文件分散到系统各处，并在注册表中留下大量条目，不易于迁移或彻底...</div></div></div></a><a class="pagination-related" href="/3137f8a10771/" title="Chocolatey (Choco) 详解：Windows 上的包管理器"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-20.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-22</div><div class="info-item-2">Chocolatey (Choco) 详解：Windows 上的包管理器</div></div><div class="info-2"><div class="info-item-1"> Chocolatey 是 Windows 平台上的一个开源包管理器，它简化了软件的安装、升级、配置和卸载过程。类似于 Linux 上的 apt 或 yum，以及 macOS 上的 Homebrew，Chocolatey 允许用户通过命令行快速、自动化地管理 Windows 应用程序和工具，极大地提高了开发人员和系统管理员的工作效率。  核心思想：将 Windows 软件的安装、升级、管理过程标准化和自动化，通过命令行实现“一键安装”，摆脱手动下载、点击下一步的繁琐。   一、为什么需要 Chocolatey？传统的 Windows 软件安装方式存在诸多不便：  手动下载：需要访问各个软件的官方网站，查找下载链接。 点击下一步：安装过程通常需要反复点击“下一步”、“同意协议”，耗时且乏味。 升级繁琐：软件升级也需要重复上述步骤，或依赖软件自带的升级器，管理不集中。 依赖管理：某些软件可能依赖于其他运行时环境或库，手动安装容易出错或遗漏。 自动化部署困难：对于需要批量部署软件的企业或自动化环境，手动安装是巨大的障碍。  Chocolatey 旨在解决这些问题，提供以下优势：  自动...</div></div></div></a><a class="pagination-related" href="/9ac45568d1c2/" title="WSL2详解：在Windows运行Linux的新标准"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-06.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-22</div><div class="info-item-2">WSL2详解：在Windows运行Linux的新标准</div></div><div class="info-2"><div class="info-item-1"> WSL 2 (适用于 Linux 的 Windows 子系统 2 - Windows Subsystem for Linux 2) 是微软推出的一项技术，它允许开发者在 Windows 操作系统上直接运行原生 Linux 环境，而无需双启动或传统虚拟机。WSL 2 相较于其前身 WSL 1，最大的变化是它运行在一个轻量级的虚拟机中，其中包含一个完整的 Linux 内核，这极大地提升了文件系统性能、系统调用兼容性和 Docker Desktop 的体验。  核心思想：在 Windows 内部无缝集成一个高性能、高度兼容的原生 Linux 环境，兼顾 Windows 的图形界面和 Linux 的命令行工具优势。   一、为什么需要 WSL 2？传统的 Linux 开发环境设置通常涉及以下几种方式：  双系统：需要重启电脑才能切换操作系统，且占用硬盘空间大。 虚拟机 (VirtualBox, VMWare)：性能开销大，与 Windows 系统的集成度不高，共享文件、剪贴板等操作相对繁琐。 WSL 1：提供了一个兼容层，将 Linux 系统调用转换为 Windows NT 内核调用。...</div></div></div></a><a class="pagination-related" href="/6d6856b2b7ad/" title="Hyper-V 深度详解：Windows 平台上的专业级虚拟化技术"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-12.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-08</div><div class="info-item-2">Hyper-V 深度详解：Windows 平台上的专业级虚拟化技术</div></div><div class="info-2"><div class="info-item-1"> Hyper-V 是微软提供的一款基于 Hypervisor 的虚拟化技术，它允许用户在单一物理服务器上运行多个独立的虚拟机 (Virtual Machines, VMs)。作为 Windows Server 操作系统的一个角色功能，以及 Windows 客户端操作系统（Pro、Enterprise、Education 版本）的一个可选功能，Hyper-V 提供了一个可靠、高效且可扩展的平台，用于创建、运行和管理虚拟机。它支持运行多种操作系统，包括 Windows、Linux 以及其他变体，是企业级数据中心、开发测试环境以及个人专业用户不可或缺的工具。  核心思想：Hyper-V 在硬件和操作系统之间插入一个薄薄的虚拟化层——Hypervisor (管理程序)。这个 Hypervisor 直接管理物理硬件资源，并高效地分配给多个虚拟机，每个虚拟机都像一台独立的物理机器一样运行，拥有自己的操作系统和应用程序，从而实现资源的隔离和高效利用。   一、虚拟化技术概述与 Hyper-V 的定位1.1 什么是虚拟化？虚拟化是一种创建事物虚拟版本（而不是物理版本）的技术，通常指创建虚拟计算机...</div></div></div></a><a class="pagination-related" href="/98c39f8e2307/" title="Go 语言协程设计与调度原理"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-04.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-05</div><div class="info-item-2">Go 语言协程设计与调度原理</div></div><div class="info-2"><div class="info-item-1"> Go 语言以其强大的并发特性而闻名，其核心是轻量级协程 (Goroutine) 和高效的调度器。理解 Goroutine 的设计理念以及 Go 运行时如何调度这些协程，对于编写高性能、高并发的 Go 应用程序至关重要。本文将深入探讨 Go 语言协程的设计哲学，并详细解析其背后支撑的 GMP 调度模型。  核心概念：  Goroutine：Go 语言的轻量级并发单元，用户态线程。 GMP 模型：Go 语言运行时调度 Goroutine 的核心模型，由 G (Goroutine)、M (Machine&#x2F;Thread)、P (Processor) 三要素组成。     一、Go 语言协程 (Goroutine) 的设计哲学传统的并发编程通常基于操作系统线程。虽然线程提供了并发能力，但它们也带来了不小的开销：  创建&#x2F;销毁开销大：创建和销毁线程需要向操作系统内核申请资源，涉及系统调用，开销较大。 上下文切换开销大：线程的上下文切换由操作系统内核完成，需要保存和恢复大量的寄存器信息，开销较大。 内存消耗大：每个线程通常需要 MB 级别的栈空间，大量线程会导致内存消耗巨...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/loading.gif" data-lazy-src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">TeaTang</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">493</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">225</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">83</div></a></div><a id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/teatang"><i class="fab fa-github"></i><span>GitHub主页</span></a><div class="card-info-social-icons"><a class="social-icon" href="mailto:tea.tang1211@gmail.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">网站更多功能即将上线，敬请期待！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81PowerShell-%E7%9A%84%E8%B5%B7%E6%BA%90%E4%B8%8E%E6%BC%94%E8%BF%9B"><span class="toc-text">一、PowerShell 的起源与演进</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-Windows-PowerShell-%E6%97%A7%E7%89%88"><span class="toc-text">1.1 Windows PowerShell (旧版)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-PowerShell-Core-PowerShell-7-%E6%96%B0%E7%89%88%EF%BC%8C%E6%8E%A8%E8%8D%90"><span class="toc-text">1.2 PowerShell Core &#x2F; PowerShell 7+ (新版，推荐)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E4%B8%BA%E4%BB%80%E4%B9%88%E9%80%89%E6%8B%A9-PowerShell%EF%BC%9F"><span class="toc-text">二、为什么选择 PowerShell？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81PowerShell-%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5%E8%AF%A6%E8%A7%A3"><span class="toc-text">三、PowerShell 核心概念详解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-Cmdlet-Command-let"><span class="toc-text">3.1 Cmdlet (Command-let)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E5%AF%B9%E8%B1%A1-Objects"><span class="toc-text">3.2 对象 (Objects)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E7%AE%A1%E9%81%93-Pipeline"><span class="toc-text">3.3 管道 (Pipeline)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-%E6%8F%90%E4%BE%9B%E7%A8%8B%E5%BA%8F-Providers"><span class="toc-text">3.4 提供程序 (Providers)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-%E6%A8%A1%E5%9D%97-Modules"><span class="toc-text">3.5 模块 (Modules)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81PowerShell-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%E4%B8%8E%E5%B8%B8%E8%A7%81-Cmdlet"><span class="toc-text">四、PowerShell 基本使用与常见 Cmdlet</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E8%8E%B7%E5%8F%96%E5%B8%AE%E5%8A%A9"><span class="toc-text">4.1 获取帮助</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E7%AE%A1%E7%90%86"><span class="toc-text">4.2 文件和目录管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E8%BF%9B%E7%A8%8B%E5%92%8C%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86"><span class="toc-text">4.3 进程和服务管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-%E6%95%B0%E6%8D%AE%E7%AD%9B%E9%80%89%E3%80%81%E6%8E%92%E5%BA%8F%E4%B8%8E%E6%A0%BC%E5%BC%8F%E5%8C%96"><span class="toc-text">4.4 数据筛选、排序与格式化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81PowerShell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B"><span class="toc-text">五、PowerShell 脚本编程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E5%8F%98%E9%87%8F"><span class="toc-text">5.1 变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5-If-ElseIf-Else"><span class="toc-text">5.2 条件语句 (If-ElseIf-Else)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5"><span class="toc-text">5.3 循环语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-%E5%87%BD%E6%95%B0"><span class="toc-text">5.4 函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5-%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86-Try-Catch-Finally"><span class="toc-text">5.5 错误处理 (Try-Catch-Finally)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-PowerShell-%E8%84%9A%E6%9C%AC%E7%A4%BA%E4%BE%8B"><span class="toc-text">5.6 PowerShell 脚本示例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7-%E7%AE%80%E8%BF%B0"><span class="toc-text">六、高级特性 (简述)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E4%B8%8E%E5%B7%A5%E5%85%B7"><span class="toc-text">七、开发环境与工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E5%AE%89%E5%85%A8%E6%80%A7%E8%80%83%E8%99%91"><span class="toc-text">八、安全性考虑</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%9D%E3%80%81%E6%80%BB%E7%BB%93"><span class="toc-text">九、总结</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/fa3d796f3333/" title="MessagePack 详解"><img src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-06.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MessagePack 详解"/></a><div class="content"><a class="title" href="/fa3d796f3333/" title="MessagePack 详解">MessagePack 详解</a><time datetime="2026-01-08T22:24:00.000Z" title="发表于 2026-01-09 06:24:00">2026-01-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/82bf00e3828f/" title="传统命令行工具的现代补强与替代方案详解"><img src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-30.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="传统命令行工具的现代补强与替代方案详解"/></a><div class="content"><a class="title" href="/82bf00e3828f/" title="传统命令行工具的现代补强与替代方案详解">传统命令行工具的现代补强与替代方案详解</a><time datetime="2026-01-06T22:24:00.000Z" title="发表于 2026-01-07 06:24:00">2026-01-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/cecf96486ef4/" title="IPC (Inter-Process Communication) 详解"><img src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-32.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="IPC (Inter-Process Communication) 详解"/></a><div class="content"><a class="title" href="/cecf96486ef4/" title="IPC (Inter-Process Communication) 详解">IPC (Inter-Process Communication) 详解</a><time datetime="2026-01-04T22:24:00.000Z" title="发表于 2026-01-05 06:24:00">2026-01-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/3059cdc5f529/" title="Golang sqlc 框架详解"><img src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-28.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Golang sqlc 框架详解"/></a><div class="content"><a class="title" href="/3059cdc5f529/" title="Golang sqlc 框架详解">Golang sqlc 框架详解</a><time datetime="2026-01-01T22:24:00.000Z" title="发表于 2026-01-02 06:24:00">2026-01-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2e2570e368f1/" title="Golang 并发 Map 详解：sync.Mutex、sync.RWMutex 与 sync.Map 对比"><img src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-17.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Golang 并发 Map 详解：sync.Mutex、sync.RWMutex 与 sync.Map 对比"/></a><div class="content"><a class="title" href="/2e2570e368f1/" title="Golang 并发 Map 详解：sync.Mutex、sync.RWMutex 与 sync.Map 对比">Golang 并发 Map 详解：sync.Mutex、sync.RWMutex 与 sync.Map 对比</a><time datetime="2025-12-31T22:24:00.000Z" title="发表于 2026-01-01 06:24:00">2026-01-01</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/cover/default_cover-13.jpg);"><div class="footer-flex"><div class="footer-flex-items"><div class="footer-flex-item"><div class="footer-flex-title">我的轨迹</div><div class="footer-flex-content"><a href="/archives/2023/" target="_blank" title="🆕 2023">🆕 2023</a><a href="/archives/2024/" target="_blank" title="🆒 2024">🆒 2024</a><a href="/archives/2025/" target="_blank" title="👨‍👩‍👦 2025">👨‍👩‍👦 2025</a><a href="/archives/2026/" target="_blank" title="🆙 2026">🆙 2026</a></div></div></div><div class="footer-flex-items"><div class="footer-flex-item"><div class="footer-flex-title">维度</div><div class="footer-flex-content"><a href="/categories/" target="_blank" title="📁 分类">📁 分类</a><a href="/tags/" target="_blank" title="🔖 标签">🔖 标签</a><a href="/categories/" target="_blank" title="📽️ 时间线">📽️ 时间线</a></div></div></div><div class="footer-flex-items"><div class="footer-flex-item"><div class="footer-flex-title">其他</div><div class="footer-flex-content"><a href="/shuoshuo" target="_blank" title="💬 说说">💬 说说</a></div></div></div></div><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2023 - 2026 By TeaTang</span><span class="framework-info"><span class="footer-separator">|</span><span>框架 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.3"></script><script src="/js/main.js?v=5.5.3"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1.7/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@19.1.3/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const config = mermaidSrc.dataset.config ? JSON.parse(mermaidSrc.dataset.config) : {}
      if (!config.theme) {
        config.theme = theme
      }
      const mermaidThemeConfig = `%%{init: ${JSON.stringify(config)}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (true) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid@11.12.2/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>(() => {
  const applyThemeDefaultsConfig = theme => {
    if (theme === 'dark-mode') {
      Chart.defaults.color = "rgba(255, 255, 255, 0.8)"
      Chart.defaults.borderColor = "rgba(255, 255, 255, 0.2)"
      Chart.defaults.scale.ticks.backdropColor = "transparent"
    } else {
      Chart.defaults.color = "rgba(0, 0, 0, 0.8)"
      Chart.defaults.borderColor = "rgba(0, 0, 0, 0.1)"
      Chart.defaults.scale.ticks.backdropColor = "transparent"
    }
  }

  // Recursively traverse the config object and automatically apply theme-specific color schemes
  const applyThemeConfig = (obj, theme) => {
    if (typeof obj !== 'object' || obj === null) return

    Object.keys(obj).forEach(key => {
      const value = obj[key]
      // If the property is an object and has theme-specific options, apply them
      if (typeof value === 'object' && value !== null) {
        if (value[theme]) {
          obj[key] = value[theme] // Apply the value for the current theme
        } else {
          // Recursively process child objects
          applyThemeConfig(value, theme)
        }
      }
    })
  }

  const runChartJS = ele => {
    window.loadChartJS = true

    Array.from(ele).forEach((item, index) => {
      const chartSrc = item.firstElementChild
      const chartID = item.getAttribute('data-chartjs-id') || ('chartjs-' + index) // Use custom ID or default ID
      const width = item.getAttribute('data-width')
      const existingCanvas = document.getElementById(chartID)

      // If a canvas already exists, remove it to avoid rendering duplicates
      if (existingCanvas) {
          existingCanvas.parentNode.remove()
      }

      const chartDefinition = chartSrc.textContent
      const canvas = document.createElement('canvas')
      canvas.id = chartID

      const div = document.createElement('div')
      div.className = 'chartjs-wrap'

      if (width) {
        div.style.width = width
      }

      div.appendChild(canvas)
      chartSrc.insertAdjacentElement('afterend', div)

      const ctx = document.getElementById(chartID).getContext('2d')

      const config = JSON.parse(chartDefinition)

      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark-mode' : 'light-mode'

      // Set default styles (initial setup)
      applyThemeDefaultsConfig(theme)

      // Automatically traverse the config and apply dual-mode color schemes
      applyThemeConfig(config, theme)

      new Chart(ctx, config)
    })
  }

  const loadChartJS = () => {
    const chartJSEle = document.querySelectorAll('#article-container .chartjs-container')
    if (chartJSEle.length === 0) return

    window.loadChartJS ? runChartJS(chartJSEle) : btf.getScript('https://cdn.jsdelivr.net/npm/chart.js@4.5.1/dist/chart.umd.min.js').then(() => runChartJS(chartJSEle))
  }

  // Listen for theme change events
  btf.addGlobalFn('themeChange', loadChartJS, 'chartjs')
  btf.addGlobalFn('encrypt', loadChartJS, 'chartjs')

  window.pjax ? loadChartJS() : document.addEventListener('DOMContentLoaded', loadChartJS)
})()</script></div><script data-pjax src="/self/btf.js"></script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/fireworks.min.js"></script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="ture"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,200,200" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js" defer="defer"></script><script>document.addEventListener('DOMContentLoaded', () => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => {
      try {
        fn()
      } catch (err) {
        console.debug('Pjax callback failed:', err)
      }
    })
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      true
        ? pjax.loadUrl('/404.html')
        : window.location.href = e.request.responseURL
    }
  })
})</script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="local-search-input"><input placeholder="搜索文章" type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.5.3"></script></div></div></body></html>