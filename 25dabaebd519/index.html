<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>JUnit (单元测试框架) 详解 | 1024 维度</title><meta name="author" content="TeaTang"><meta name="copyright" content="TeaTang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="JUnit 是一个开源的 Java 语言单元测试框架，也是 Java 开发中最常用、最具影响力的测试框架之一。它提供了一套用于编写和运行可重复测试的工具集，旨在帮助开发者实现测试驱动开发 (TDD) 和确保代码质量。JUnit 是 xUnit 家族的一员，它的核心理念是：先编写测试，再编写业务代码，并确保测试能够通过，从而验证代码的正确性。  核心思想：JUnit 提供了一套标准化的注解和断言方">
<meta property="og:type" content="article">
<meta property="og:title" content="JUnit (单元测试框架) 详解">
<meta property="og:url" content="https://blog.tbf1211.xx.kg/25dabaebd519/index.html">
<meta property="og:site_name" content="1024 维度">
<meta property="og:description" content="JUnit 是一个开源的 Java 语言单元测试框架，也是 Java 开发中最常用、最具影响力的测试框架之一。它提供了一套用于编写和运行可重复测试的工具集，旨在帮助开发者实现测试驱动开发 (TDD) 和确保代码质量。JUnit 是 xUnit 家族的一员，它的核心理念是：先编写测试，再编写业务代码，并确保测试能够通过，从而验证代码的正确性。  核心思想：JUnit 提供了一套标准化的注解和断言方">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog.tbf1211.xx.kg/img/cover/default_cover-27.jpg">
<meta property="article:published_time" content="2024-02-16T22:24:00.000Z">
<meta property="article:modified_time" content="2026-02-01T09:41:47.044Z">
<meta property="article:author" content="TeaTang">
<meta property="article:tag" content="程序设计">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="测试">
<meta property="article:tag" content="2024">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.tbf1211.xx.kg/img/cover/default_cover-27.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "JUnit (单元测试框架) 详解",
  "url": "https://blog.tbf1211.xx.kg/25dabaebd519/",
  "image": "https://blog.tbf1211.xx.kg/img/cover/default_cover-27.jpg",
  "datePublished": "2024-02-16T22:24:00.000Z",
  "dateModified": "2026-02-01T09:41:47.044Z",
  "author": [
    {
      "@type": "Person",
      "name": "TeaTang",
      "url": "https://blog.tbf1211.xx.kg"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon-1.ico"><link rel="canonical" href="https://blog.tbf1211.xx.kg/25dabaebd519/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><meta name="google-site-verification" content="NdIUXAOVyGnnBhcrip0ksCawbdAzT0hlBZDE9u4jx6k"/><meta name="msvalidate.01" content="567E47D75E8DCF1282B9623AD914701E"/><meta name="baidu-site-verification" content="code-pE5rnuxcfD"/><link rel="stylesheet" href="/css/index.css?v=5.5.4"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1.9/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          const mediaQueryDark = window.matchMedia('(prefers-color-scheme: dark)')
          const mediaQueryLight = window.matchMedia('(prefers-color-scheme: light)')

          if (theme === undefined) {
            if (mediaQueryLight.matches) activateLightMode()
            else if (mediaQueryDark.matches) activateDarkMode()
            else {
              const hour = new Date().getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            mediaQueryDark.addEventListener('change', () => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else {
            theme === 'light' ? activateLightMode() : activateDarkMode()
          }
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.json","preload":false,"top_n_per_article":1,"unescape":false,"pagination":{"enable":true,"hitsPerPage":8},"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":400,"highlightFullpage":true,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":150,"languages":{"author":"作者: TeaTang","link":"链接: ","source":"来源: 1024 维度","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.13.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'JUnit (单元测试框架) 详解',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="preconnect" href="https://jsd.012700.xyz"><link href="/self/btf.css" rel="stylesheet"><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="1024 维度" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/loading.gif" data-lazy-src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">536</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">229</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">84</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 我的轨迹</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/2023/"><i class="fa-fw fa-solid fa-bug"></i><span> 2023</span></a></li><li><a class="site-page child" href="/archives/2024/"><i class="fa-fw fa-solid fa-code"></i><span> 2024</span></a></li><li><a class="site-page child" href="/archives/2025/"><i class="fa-fw fa-solid fa-network-wired"></i><span> 2025</span></a></li><li><a class="site-page child" href="/archives/2026/"><i class="fa-fw fa-solid fa-code-branch"></i><span> 2026</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa-solid fa-calendar-days"></i><span> 时间线</span></a></div><div class="menus_item"><a class="site-page" href="/shuoshuo"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url(/img/cover/default_cover-27.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">1024 维度</span></a><a class="nav-page-title" href="/"><span class="site-name">JUnit (单元测试框架) 详解</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 我的轨迹</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/2023/"><i class="fa-fw fa-solid fa-bug"></i><span> 2023</span></a></li><li><a class="site-page child" href="/archives/2024/"><i class="fa-fw fa-solid fa-code"></i><span> 2024</span></a></li><li><a class="site-page child" href="/archives/2025/"><i class="fa-fw fa-solid fa-network-wired"></i><span> 2025</span></a></li><li><a class="site-page child" href="/archives/2026/"><i class="fa-fw fa-solid fa-code-branch"></i><span> 2026</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa-solid fa-calendar-days"></i><span> 时间线</span></a></div><div class="menus_item"><a class="site-page" href="/shuoshuo"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">JUnit (单元测试框架) 详解</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2024-02-16T22:24:00.000Z" title="发表于 2024-02-17 06:24:00">2024-02-17</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Java/">Java</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Java/%E5%BA%93/">库</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">3.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>14分钟</span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><blockquote>
<p><strong>JUnit</strong> 是一个开源的 Java 语言<strong>单元测试框架</strong>，也是 Java 开发中最常用、最具影响力的测试框架之一。它提供了一套用于编写和运行可重复测试的工具集，旨在帮助开发者实现<strong>测试驱动开发 (TDD)</strong> 和确保代码质量。JUnit 是 xUnit 家族的一员，它的核心理念是：<strong>先编写测试，再编写业务代码，并确保测试能够通过，从而验证代码的正确性。</strong></p>
</blockquote>
<div class="note info flat"><p>核心思想：<strong>JUnit 提供了一套标准化的注解和断言方法，使得开发者能够以结构化、可自动化执行的方式，对程序中的最小可测试单元（通常是方法）进行验证，确保其行为符合预期。</strong></p>
</div>

<hr>
<h2 id="一、为什么需要单元测试与-JUnit？"><a href="#一、为什么需要单元测试与-JUnit？" class="headerlink" title="一、为什么需要单元测试与 JUnit？"></a>一、为什么需要单元测试与 JUnit？</h2><p>在软件开发过程中，测试是不可或缺的一环。单元测试尤其重要，它专注于测试程序中最小的功能模块（例如一个类的一个方法）。没有单元测试，开发者会面临以下挑战：</p>
<ol>
<li><strong>代码质量难以保证</strong>：无法及时发现代码中的逻辑错误、边界条件问题。</li>
<li><strong>回归测试困难</strong>：修改现有代码后，很难确保没有引入新的 Bug 到原有功能中。</li>
<li><strong>重构风险高</strong>：缺乏测试覆盖的代码，在重构时容易引入新的问题，因为无法快速验证重构后的代码是否依然正确。</li>
<li><strong>调试成本高</strong>：问题往往在集成测试或生产环境中才被发现，此时定位和修复 Bug 的成本会急剧增加。</li>
<li><strong>代码设计不良</strong>：测试驱动开发 (TDD) 鼓励编写可测试的代码，这通常意味着更好的模块化、更清晰的接口和更低的代码耦合度。</li>
</ol>
<p>JUnit 解决了这些问题，它提供了：</p>
<ul>
<li><strong>自动化测试</strong>：测试代码可以被自动化执行，提高了测试效率。</li>
<li><strong>快速反馈</strong>：可以在开发早期发现和修复 Bug，降低了修复成本。</li>
<li><strong>提高代码质量</strong>：通过测试验证代码行为，减少错误。</li>
<li><strong>支持重构</strong>：提供安全网，让开发者有信心进行代码重构。</li>
<li><strong>改进代码设计</strong>：鼓励编写易于测试的、低耦合的代码。</li>
<li><strong>清晰的测试报告</strong>：直观展示哪些测试通过，哪些失败，以及失败原因。</li>
</ul>
<h2 id="二、JUnit-发展历程-JUnit-4-vs-JUnit-5"><a href="#二、JUnit-发展历程-JUnit-4-vs-JUnit-5" class="headerlink" title="二、JUnit 发展历程 (JUnit 4 vs. JUnit 5)"></a>二、JUnit 发展历程 (JUnit 4 vs. JUnit 5)</h2><p>JUnit 经历了多个主要版本迭代，其中 JUnit 4 和 JUnit 5 是目前最常用的两个版本。</p>
<h3 id="2-1-JUnit-4"><a href="#2-1-JUnit-4" class="headerlink" title="2.1 JUnit 4"></a>2.1 JUnit 4</h3><ul>
<li><strong>成熟稳定</strong>：广泛应用于旧项目。</li>
<li><strong>核心注解</strong>：<code>@Test</code>, <code>@Before</code>, <code>@After</code>, <code>@BeforeClass</code>, <code>@AfterClass</code>, <code>@Ignore</code> 等。</li>
<li><strong>单 jar 包</strong>：所有功能都在一个 <code>junit-x.x.jar</code> 包中。</li>
<li><strong>反射机制</strong>：在运行时通过反射查找并执行测试方法。</li>
<li><strong>限制</strong>：不支持 Java 8 及以上版本的一些新特性（如 Lambda 表达式），扩展性有限。</li>
</ul>
<h3 id="2-2-JUnit-5-JUnit-Jupiter"><a href="#2-2-JUnit-5-JUnit-Jupiter" class="headerlink" title="2.2 JUnit 5 (JUnit Jupiter)"></a>2.2 JUnit 5 (JUnit Jupiter)</h3><ul>
<li><strong>模块化</strong>：由多个模块组成，最核心的是：<ul>
<li><strong>JUnit Platform</strong>：定义了测试引擎的 API，允许不同测试框架（如 JUnit Jupiter, JUnit Vintage, TestNG）运行在同一个平台上。</li>
<li><strong>JUnit Jupiter</strong>：是 JUnit 5 编写新测试的编程模型和扩展模型，提供了新的注解和功能。</li>
<li><strong>JUnit Vintage</strong>：用于兼容运行 JUnit 3 和 JUnit 4 的测试。</li>
</ul>
</li>
<li><strong>新注解</strong>：<code>@BeforeEach</code>, <code>@AfterEach</code>, <code>@BeforeAll</code>, <code>@AfterAll</code>, <code>@DisplayName</code>, <code>@Disabled</code>, <code>@Nested</code>, <code>@ParameterizedTest</code> 等，语义更清晰，功能更强大。</li>
<li><strong>Java 8+ 特性支持</strong>：充分利用 Lambda 表达式、Stream API 等特性。</li>
<li><strong>强大的扩展模型</strong>：允许开发者自定义测试行为（如条件执行、参数化测试、依赖注入等）。</li>
<li><strong>推荐使用</strong>：现代 Java 项目推荐使用 JUnit 5。</li>
</ul>
<p><strong>本文将以 JUnit 5 为主进行讲解。</strong></p>
<h2 id="三、JUnit-5-核心概念与注解"><a href="#三、JUnit-5-核心概念与注解" class="headerlink" title="三、JUnit 5 核心概念与注解"></a>三、JUnit 5 核心概念与注解</h2><h3 id="3-1-Maven-依赖-pom-xml"><a href="#3-1-Maven-依赖-pom-xml" class="headerlink" title="3.1 Maven 依赖 (pom.xml)"></a>3.1 Maven 依赖 (pom.xml)</h3><p>在 Spring Boot 项目中，通常引入 <code>spring-boot-starter-test</code> 即可，它会包含 JUnit Jupiter。对于非 Spring Boot 项目，需要手动引入：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.jupiter<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-jupiter-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.10.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span> <span class="comment">&lt;!-- 使用最新稳定版本 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.jupiter<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-jupiter-engine<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.10.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 如果需要运行 JUnit 4 测试，可以添加 JUnit Vintage Engine --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    &lt;dependency&gt;</span></span><br><span class="line"><span class="comment">        &lt;groupId&gt;org.junit.vintage&lt;/groupId&gt;</span></span><br><span class="line"><span class="comment">        &lt;artifactId&gt;junit-vintage-engine&lt;/artifactId&gt;</span></span><br><span class="line"><span class="comment">        &lt;version&gt;5.10.1&lt;/version&gt;</span></span><br><span class="line"><span class="comment">        &lt;scope&gt;test&lt;/scope&gt;</span></span><br><span class="line"><span class="comment">    &lt;/dependency&gt;</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-2-核心注解"><a href="#3-2-核心注解" class="headerlink" title="3.2 核心注解"></a>3.2 核心注解</h3><table>
<thead>
<tr>
<th align="left">注解名称</th>
<th align="left">作用域</th>
<th align="left">描述</th>
<th align="left">JUnit 4 对应注解</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>@Test</code></td>
<td align="left">方法</td>
<td align="left">标记一个普通测试方法。</td>
<td align="left"><code>@Test</code></td>
</tr>
<tr>
<td align="left"><code>@BeforeEach</code></td>
<td align="left">方法</td>
<td align="left">在每个 <code>@Test</code> 方法<strong>之前</strong>执行。通常用于初始化每个测试方法所需的对象或状态。</td>
<td align="left"><code>@Before</code></td>
</tr>
<tr>
<td align="left"><code>@AfterEach</code></td>
<td align="left">方法</td>
<td align="left">在每个 <code>@Test</code> 方法<strong>之后</strong>执行。通常用于清理每个测试方法留下的资源。</td>
<td align="left"><code>@After</code></td>
</tr>
<tr>
<td align="left"><code>@BeforeAll</code></td>
<td align="left">静态方法</td>
<td align="left">在所有 <code>@Test</code> 方法<strong>之前</strong>执行，且<strong>只执行一次</strong>。通常用于重量级资源的初始化，如数据库连接池。</td>
<td align="left"><code>@BeforeClass</code></td>
</tr>
<tr>
<td align="left"><code>@AfterAll</code></td>
<td align="left">静态方法</td>
<td align="left">在所有 <code>@Test</code> 方法<strong>之后</strong>执行，且<strong>只执行一次</strong>。通常用于清理 <code>@BeforeAll</code> 中初始化的资源。</td>
<td align="left"><code>@AfterClass</code></td>
</tr>
<tr>
<td align="left"><code>@DisplayName</code></td>
<td align="left">类&#x2F;方法</td>
<td align="left">为测试类或测试方法提供一个更具可读性的名称，会显示在测试报告中。</td>
<td align="left">无</td>
</tr>
<tr>
<td align="left"><code>@Disabled</code></td>
<td align="left">类&#x2F;方法</td>
<td align="left">禁用（跳过）某个测试类或测试方法。</td>
<td align="left"><code>@Ignore</code></td>
</tr>
<tr>
<td align="left"><code>@Nested</code></td>
<td align="left">内部类</td>
<td align="left">标记一个非静态内部类为嵌套测试类，有助于组织和分组测试。</td>
<td align="left">无</td>
</tr>
<tr>
<td align="left"><code>@ParameterizedTest</code></td>
<td align="left">方法</td>
<td align="left">标记一个参数化测试方法，可以传入不同的参数多次运行同一个测试方法。</td>
<td align="left"><code>@RunWith(Parameterized.class)</code></td>
</tr>
<tr>
<td align="left"><code>@TestFactory</code></td>
<td align="left">方法</td>
<td align="left">标记一个动态测试工厂方法，返回 <code>DynamicTest</code> 集合，允许运行时生成测试用例。</td>
<td align="left">无</td>
</tr>
<tr>
<td align="left"><code>@Tag</code></td>
<td align="left">类&#x2F;方法</td>
<td align="left">为测试添加标签，可以在运行测试时根据标签筛选要执行的测试。</td>
<td align="left">无</td>
</tr>
<tr>
<td align="left"><code>@ExtendWith</code></td>
<td align="left">类&#x2F;方法</td>
<td align="left">注册一个 JUnit 扩展，用于自定义测试行为，如条件执行、参数解析、生命周期回调等。</td>
<td align="left"><code>@RunWith</code></td>
</tr>
</tbody></table>
<h3 id="3-3-常用断言-Assertions"><a href="#3-3-常用断言-Assertions" class="headerlink" title="3.3 常用断言 (Assertions)"></a>3.3 常用断言 (Assertions)</h3><p>JUnit 提供了一系列静态方法用于断言，通常通过 <code>org.junit.jupiter.api.Assertions</code> 类引入。</p>
<table>
<thead>
<tr>
<th align="left">断言方法</th>
<th align="left">描述</th>
<th align="left">示例</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>assertTrue(boolean condition)</code></td>
<td align="left">断言条件为真。</td>
<td align="left"><code>assertTrue(result &gt; 0);</code></td>
</tr>
<tr>
<td align="left"><code>assertFalse(boolean condition)</code></td>
<td align="left">断言条件为假。</td>
<td align="left"><code>assertFalse(result &lt; 0);</code></td>
</tr>
<tr>
<td align="left"><code>assertNull(Object actual)</code></td>
<td align="left">断言对象为 <code>null</code>。</td>
<td align="left"><code>assertNull(user);</code></td>
</tr>
<tr>
<td align="left"><code>assertNotNull(Object actual)</code></td>
<td align="left">断言对象不为 <code>null</code>。</td>
<td align="left"><code>assertNotNull(user);</code></td>
</tr>
<tr>
<td align="left"><code>assertEquals(expected, actual)</code></td>
<td align="left">断言预期值与实际值相等（支持基本类型、对象）。</td>
<td align="left"><code>assertEquals(5, sum(2, 3));</code></td>
</tr>
<tr>
<td align="left"><code>assertNotEquals(unexpected, actual)</code></td>
<td align="left">断言预期值与实际值不相等。</td>
<td align="left"><code>assertNotEquals(0, result);</code></td>
</tr>
<tr>
<td align="left"><code>assertSame(expected, actual)</code></td>
<td align="left">断言两个对象是同一个实例。</td>
<td align="left"><code>assertSame(list1, list2);</code></td>
</tr>
<tr>
<td align="left"><code>assertNotSame(unexpected, actual)</code></td>
<td align="left">断言两个对象不是同一个实例。</td>
<td align="left"><code>assertNotSame(obj1, obj2);</code></td>
</tr>
<tr>
<td align="left"><code>assertArrayEquals(expectedArray, actualArray)</code></td>
<td align="left">断言两个数组内容相等。</td>
<td align="left"><code>assertArrayEquals(new int[]&#123;1,2&#125;, result);</code></td>
</tr>
<tr>
<td align="left"><code>assertThrows(Class&lt;? extends Throwable&gt; expectedType, Executable executable)</code></td>
<td align="left">断言执行 <code>executable</code> 会抛出指定类型的异常。</td>
<td align="left"><code>assertThrows(IllegalArgumentException.class, () -&gt; divide(1, 0));</code></td>
</tr>
<tr>
<td align="left"><code>assertDoesNotThrow(Executable executable)</code></td>
<td align="left">断言执行 <code>executable</code> 不会抛出任何异常。</td>
<td align="left"><code>assertDoesNotThrow(() -&gt; someMethod());</code></td>
</tr>
<tr>
<td align="left"><code>assertAll(Executable... executables)</code></td>
<td align="left">组合多个断言，即使前面的断言失败，也会执行所有断言。</td>
<td align="left"><code>assertAll(&quot;User Properties&quot;, () -&gt; assertEquals(&quot;John&quot;, user.getName()), () -&gt; assertEquals(30, user.getAge()));</code></td>
</tr>
</tbody></table>
<h2 id="四、JUnit-5-示例代码"><a href="#四、JUnit-5-示例代码" class="headerlink" title="四、JUnit 5 示例代码"></a>四、JUnit 5 示例代码</h2><p>假设我们有一个简单的计算器类 <code>Calculator</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/main/java/com/example/Calculator.java</span></span><br><span class="line"><span class="keyword">package</span> com.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Calculator</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> a + b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">subtract</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> a - b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">multiply</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> a * b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">divide</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (b == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;Divisor cannot be zero.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> a / b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>现在我们为 <code>Calculator</code> 类编写 JUnit 5 测试：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/test/java/com/example/CalculatorTest.java</span></span><br><span class="line"><span class="keyword">package</span> com.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.*; <span class="comment">// 导入所有 JUnit Jupiter 注解和断言</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.jupiter.api.Assertions.*; <span class="comment">// 导入静态断言方法</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@DisplayName(&quot;Calculator 测试类&quot;)</span> <span class="comment">// 为测试类添加显示名称</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CalculatorTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Calculator calculator; <span class="comment">// 待测试的类实例</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 在所有测试方法执行之前执行一次，用于设置整个测试套件的共享资源</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@BeforeAll</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setupAll</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;--- @BeforeAll: 初始化所有测试的共享资源 ---&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 在每个测试方法执行之前执行，用于初始化每个测试方法所需的状态</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@BeforeEach</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">setup</span><span class="params">()</span> &#123;</span><br><span class="line">        calculator = <span class="keyword">new</span> <span class="title class_">Calculator</span>();</span><br><span class="line">        System.out.println(<span class="string">&quot;  @BeforeEach: 初始化 Calculator 实例&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 测试 add 方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@DisplayName(&quot;测试加法：正数相加&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testAddPositiveNumbers</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;    @Test: testAddPositiveNumbers&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> calculator.add(<span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">        assertEquals(<span class="number">5</span>, result, <span class="string">&quot;2 + 3 应该等于 5&quot;</span>); <span class="comment">// 带有消息的断言</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 测试 subtract 方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@DisplayName(&quot;测试减法：负数结果&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testSubtractNegativeResult</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;    @Test: testSubtractNegativeResult&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> calculator.subtract(<span class="number">5</span>, <span class="number">10</span>);</span><br><span class="line">        assertEquals(-<span class="number">5</span>, result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 测试 multiply 方法，使用多个断言</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@DisplayName(&quot;测试乘法：零和非零数&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testMultiply</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;    @Test: testMultiply&quot;</span>);</span><br><span class="line">        <span class="comment">// 组合断言，即使第一个失败，也会执行所有断言</span></span><br><span class="line">        assertAll(<span class="string">&quot;Multiply Tests&quot;</span>,</span><br><span class="line">            () -&gt; assertEquals(<span class="number">0</span>, calculator.multiply(<span class="number">5</span>, <span class="number">0</span>), <span class="string">&quot;任何数乘以0应为0&quot;</span>),</span><br><span class="line">            () -&gt; assertEquals(<span class="number">10</span>, calculator.multiply(<span class="number">2</span>, <span class="number">5</span>), <span class="string">&quot;2乘以5应为10&quot;</span>),</span><br><span class="line">            () -&gt; assertEquals(-<span class="number">12</span>, calculator.multiply(<span class="number">3</span>, -<span class="number">4</span>), <span class="string">&quot;3乘以-4应为-12&quot;</span>)</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 测试 divide 方法的正常情况</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@DisplayName(&quot;测试除法：正常情况&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testDivideNormal</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;    @Test: testDivideNormal&quot;</span>);</span><br><span class="line">        assertEquals(<span class="number">2</span>, calculator.divide(<span class="number">10</span>, <span class="number">5</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 测试 divide 方法抛出异常的边界情况</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@DisplayName(&quot;测试除法：除数为零时抛出异常&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testDivideByZeroThrowsException</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;    @Test: testDivideByZeroThrowsException&quot;</span>);</span><br><span class="line">        <span class="comment">// 断言会抛出 IllegalArgumentException</span></span><br><span class="line">        assertThrows(IllegalArgumentException.class, () -&gt; calculator.divide(<span class="number">1</span>, <span class="number">0</span>), <span class="string">&quot;除数为零应抛出 IllegalArgumentException&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 禁用某个测试方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@Disabled(&quot;此测试目前被禁用&quot;)</span></span><br><span class="line">    <span class="meta">@DisplayName(&quot;测试一个禁用功能&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testDisabledMethod</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;    @Test: This test will not be executed.&quot;</span>);</span><br><span class="line">        fail(<span class="string">&quot;此方法不应被执行&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 在每个测试方法执行之后执行，用于清理每个测试方法可能留下的资源</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@AfterEach</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">tearDown</span><span class="params">()</span> &#123;</span><br><span class="line">        calculator = <span class="literal">null</span>; <span class="comment">// 清理实例</span></span><br><span class="line">        System.out.println(<span class="string">&quot;  @AfterEach: 清理 Calculator 实例&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 在所有测试方法执行之后执行一次，用于清理整个测试套件的共享资源</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@AfterAll</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">tearDownAll</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;--- @AfterAll: 清理所有测试的共享资源 ---&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>运行结果示例 (可能因IDE或构建工具略有差异)：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">--- @BeforeAll: 初始化所有测试的共享资源 ---</span><br><span class="line">  @BeforeEach: 初始化 Calculator 实例</span><br><span class="line">    @Test: testAddPositiveNumbers</span><br><span class="line">  @AfterEach: 清理 Calculator 实例</span><br><span class="line">  @BeforeEach: 初始化 Calculator 实例</span><br><span class="line">    @Test: testSubtractNegativeResult</span><br><span class="line">  @AfterEach: 清理 Calculator 实例</span><br><span class="line">  @BeforeEach: 初始化 Calculator 实例</span><br><span class="line">    @Test: testMultiply</span><br><span class="line">  @AfterEach: 清理 Calculator 实例</span><br><span class="line">  @BeforeEach: 初始化 Calculator 实例</span><br><span class="line">    @Test: testDivideNormal</span><br><span class="line">  @AfterEach: 清理 Calculator 实例</span><br><span class="line">  @BeforeEach: 初始化 Calculator 实例</span><br><span class="line">    @Test: testDivideByZeroThrowsException</span><br><span class="line">  @AfterEach: 清理 Calculator 实例</span><br><span class="line">--- @AfterAll: 清理所有测试的共享资源 ---</span><br><span class="line"></span><br><span class="line">[显示测试结果：5 tests run, 0 failures, 1 skipped]</span><br></pre></td></tr></table></figure>

<h2 id="五、JUnit-5-进阶功能"><a href="#五、JUnit-5-进阶功能" class="headerlink" title="五、JUnit 5 进阶功能"></a>五、JUnit 5 进阶功能</h2><h3 id="5-1-参数化测试-ParameterizedTest"><a href="#5-1-参数化测试-ParameterizedTest" class="headerlink" title="5.1 参数化测试 (@ParameterizedTest)"></a>5.1 参数化测试 (<code>@ParameterizedTest</code>)</h3><p>允许用不同的参数多次运行同一个测试方法，非常适合测试边界条件。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// CalculatorTest.java 中添加</span></span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.params.ParameterizedTest;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.params.provider.CsvSource;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.params.provider.ValueSource;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ParameterizedCalculatorTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Calculator calculator;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@BeforeEach</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">setup</span><span class="params">()</span> &#123;</span><br><span class="line">        calculator = <span class="keyword">new</span> <span class="title class_">Calculator</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ParameterizedTest(name = &quot;&#123;index&#125; =&gt; add(&#123;0&#125;, &#123;1&#125;) = &#123;2&#125;&quot;)</span> <span class="comment">// 自定义测试名称</span></span><br><span class="line">    <span class="meta">@CsvSource(&#123; // 提供 CSV 格式的参数</span></span><br><span class="line"><span class="meta">            &quot;1, 1, 2&quot;,</span></span><br><span class="line"><span class="meta">            &quot;2, 3, 5&quot;,</span></span><br><span class="line"><span class="meta">            &quot;10, -5, 5&quot;,</span></span><br><span class="line"><span class="meta">            &quot;0, 0, 0&quot;</span></span><br><span class="line"><span class="meta">    &#125;)</span></span><br><span class="line">    <span class="meta">@DisplayName(&quot;参数化测试：加法&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testAddParameterized</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> expectedSum)</span> &#123;</span><br><span class="line">        assertEquals(expectedSum, calculator.add(a, b));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ParameterizedTest(name = &quot;&#123;index&#125; =&gt; multiply(&#123;0&#125;, 0) = 0&quot;)</span></span><br><span class="line">    <span class="meta">@ValueSource(ints = &#123;1, 5, 100, -20&#125;)</span> <span class="comment">// 提供单个 int 类型的参数</span></span><br><span class="line">    <span class="meta">@DisplayName(&quot;参数化测试：乘以零&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testMultiplyByZero</span><span class="params">(<span class="type">int</span> a)</span> &#123;</span><br><span class="line">        assertEquals(<span class="number">0</span>, calculator.multiply(a, <span class="number">0</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-2-嵌套测试-Nested"><a href="#5-2-嵌套测试-Nested" class="headerlink" title="5.2 嵌套测试 (@Nested)"></a>5.2 嵌套测试 (<code>@Nested</code>)</h3><p>通过内部类更好地组织相关联的测试，每个嵌套类都可以有自己的 <code>@BeforeEach</code> 和 <code>@AfterEach</code>。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// CalculatorTest.java 中添加</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NestedCalculatorTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Calculator calculator;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@BeforeEach</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">setup</span><span class="params">()</span> &#123;</span><br><span class="line">        calculator = <span class="keyword">new</span> <span class="title class_">Calculator</span>();</span><br><span class="line">        System.out.println(<span class="string">&quot;  NestedCalculatorTest: 初始化 Calculator&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterEach</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">tearDown</span><span class="params">()</span> &#123;</span><br><span class="line">        calculator = <span class="literal">null</span>;</span><br><span class="line">        System.out.println(<span class="string">&quot;  NestedCalculatorTest: 清理 Calculator&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Nested</span></span><br><span class="line">    <span class="meta">@DisplayName(&quot;测试正数运算&quot;)</span></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">PositiveNumbersTests</span> &#123;</span><br><span class="line">        <span class="meta">@BeforeEach</span></span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">setupPositive</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;    PositiveNumbersTests: 准备正数测试&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Test</span></span><br><span class="line">        <span class="meta">@DisplayName(&quot;正数加法&quot;)</span></span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">testAddPositive</span><span class="params">()</span> &#123;</span><br><span class="line">            assertEquals(<span class="number">5</span>, calculator.add(<span class="number">2</span>, <span class="number">3</span>));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Test</span></span><br><span class="line">        <span class="meta">@DisplayName(&quot;正数乘法&quot;)</span></span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">testMultiplyPositive</span><span class="params">()</span> &#123;</span><br><span class="line">            assertEquals(<span class="number">6</span>, calculator.multiply(<span class="number">2</span>, <span class="number">3</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Nested</span></span><br><span class="line">    <span class="meta">@DisplayName(&quot;测试负数和零运算&quot;)</span></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">NegativeAndZeroTests</span> &#123;</span><br><span class="line">        <span class="meta">@BeforeEach</span></span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">setupNegative</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;    NegativeAndZeroTests: 准备负数/零测试&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Test</span></span><br><span class="line">        <span class="meta">@DisplayName(&quot;负数加法&quot;)</span></span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">testAddNegative</span><span class="params">()</span> &#123;</span><br><span class="line">            assertEquals(-<span class="number">5</span>, calculator.add(-<span class="number">2</span>, -<span class="number">3</span>));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Test</span></span><br><span class="line">        <span class="meta">@DisplayName(&quot;乘以零&quot;)</span></span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">testMultiplyByZero</span><span class="params">()</span> &#123;</span><br><span class="line">            assertEquals(<span class="number">0</span>, calculator.multiply(<span class="number">100</span>, <span class="number">0</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-3-标签-Tag"><a href="#5-3-标签-Tag" class="headerlink" title="5.3 标签 (@Tag)"></a>5.3 标签 (<code>@Tag</code>)</h3><p>可以为测试添加标签，然后在构建工具或 IDE 中根据标签过滤运行特定的测试。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在 @Test 或 @Nested 等注解旁添加</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="meta">@Tag(&quot;fast&quot;)</span> <span class="comment">// 标记为快速测试</span></span><br><span class="line"><span class="meta">@DisplayName(&quot;快速加法测试&quot;)</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testFastAdd</span><span class="params">()</span> &#123;</span><br><span class="line">    assertEquals(<span class="number">5</span>, calculator.add(<span class="number">2</span>, <span class="number">3</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="meta">@Tag(&quot;slow&quot;)</span> <span class="comment">// 标记为慢速测试</span></span><br><span class="line"><span class="meta">@DisplayName(&quot;慢速集成测试&quot;)</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testSlowIntegration</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 模拟耗时操作</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        Thread.currentThread().interrupt();</span><br><span class="line">    &#125;</span><br><span class="line">    assertTrue(<span class="literal">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行 Maven 命令时可以通过 <code>-Dgroups=fast</code> 或 <code>-Dexcludes.groups=slow</code> 来执行或排除特定标签的测试。</p>
<h2 id="六、测试驱动开发-TDD-简介"><a href="#六、测试驱动开发-TDD-简介" class="headerlink" title="六、测试驱动开发 (TDD) 简介"></a>六、测试驱动开发 (TDD) 简介</h2><p>JUnit 是实现 TDD 的核心工具。TDD 的基本流程是：</p>
<ol>
<li><strong>红 (Red)</strong>：先写一个失败的测试。</li>
<li><strong>绿 (Green)</strong>：编写最少量的代码让测试通过。</li>
<li><strong>重构 (Refactor)</strong>：优化代码，同时确保所有测试仍然通过。</li>
</ol>
<p>这个循环不断重复，确保每次代码修改都有测试覆盖，从而持续提高代码质量。</p>
<h2 id="七、最佳实践"><a href="#七、最佳实践" class="headerlink" title="七、最佳实践"></a>七、最佳实践</h2><ol>
<li><strong>单一职责原则</strong>：每个测试方法只测试一个功能点。</li>
<li><strong>独立性</strong>：测试方法之间不应该有依赖，每个测试都应该能够独立运行，并且其执行顺序不影响结果。</li>
<li><strong>可重复性</strong>：每次运行测试都应该得到相同的结果。</li>
<li><strong>清晰的命名</strong>：测试类和测试方法应具有描述性，清晰地表达其测试目的（例如 <code>testMethodName_scenario_expectedResult()</code>）。</li>
<li><strong>隔离性</strong>：单元测试应尽量隔离被测代码与外部依赖（如数据库、网络），通常通过<strong>Mock&#x2F;Stub</strong>技术实现。</li>
<li><strong>覆盖率</strong>：通过代码覆盖率工具（如 JaCoCo）监控测试覆盖率，但不应盲目追求高覆盖率，而应关注关键业务逻辑的覆盖。</li>
<li><strong>及时更新</strong>：当业务代码发生变化时，及时更新或新增相应的测试。</li>
<li><strong>断言消息</strong>：为断言提供有意义的失败消息，有助于快速定位问题。</li>
</ol>
<h2 id="八、总结"><a href="#八、总结" class="headerlink" title="八、总结"></a>八、总结</h2><p>JUnit 作为 Java 领域最流行的单元测试框架，为开发者提供了一套强大而灵活的工具集，用于编写高质量、可维护的测试代码。无论是 JUnit 4 还是更现代的 JUnit 5，它们都秉持着“测试先行”的理念，帮助开发者在开发早期发现问题，确保代码的正确性和稳定性。掌握 JUnit 的使用是每个 Java 开发者提升代码质量和开发效率的必备技能。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://blog.tbf1211.xx.kg">TeaTang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://blog.tbf1211.xx.kg/25dabaebd519/">https://blog.tbf1211.xx.kg/25dabaebd519/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://blog.tbf1211.xx.kg" target="_blank">1024 维度</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/">程序设计</a><a class="post-meta__tags" href="/tags/Java/">Java</a><a class="post-meta__tags" href="/tags/%E6%B5%8B%E8%AF%95/">测试</a><a class="post-meta__tags" href="/tags/2024/">2024</a></div><div class="post-share"><div class="social-share" data-image="/img/cover/default_cover-27.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/b8edc2276249/" title="雪花算法 (Snowflake Algorithm) 详解"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-07.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">雪花算法 (Snowflake Algorithm) 详解</div></div><div class="info-2"><div class="info-item-1"> 雪花算法 (Snowflake Algorithm) 是 Twitter 公司开源的一种分布式唯一 ID 生成算法。它旨在解决在分布式系统中生成全局唯一、递增（但非严格递增）且高性能 ID 的需求。其生成的 ID 是一个 64 位的整数，具有时间有序性，并且不依赖于数据库，易于扩展。  核心思想：将 64 位的 Long 型 ID 拆分为多个字段，分别存储时间戳、数据中心 ID、机器 ID 和序列号，通过位运算拼接以保证全局唯一性和大致的时间有序性。   一、为什么需要雪花算法？在分布式系统中，传统的单点自增 ID 方案面临巨大挑战：  唯一性问题：不同的数据库实例或服务节点可能生成相同的 ID。 性能瓶颈：为了保证唯一性，可能需要引入中心化的 ID 生成服务或数据库锁，成为系统瓶颈。 可用性问题：中心化服务一旦宕机，整个系统的 ID 生成将受影响。  虽然 UUID 能够保证全局唯一性，但它存在一些缺点：  存储和传输效率低：128 位，比 64 位 ID 更占用空间，索引性能较差。 无序性：UUID 是无序的，插入数据库时会导致 B+ 树索引频繁分裂和重建，影响数据库性能。...</div></div></div></a><a class="pagination-related" href="/25324aef0ab0/" title="Git Merge vs. Rebase 对比详解"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-14.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">Git Merge vs. Rebase 对比详解</div></div><div class="info-2"><div class="info-item-1"> 在 Git 版本控制系统中，git merge 和 git rebase 是两种常用的代码集成命令，它们都用于将一个分支的更改合并到另一个分支。尽管目的相同，但它们实现这一目标的方式截然不同，对项目的历史记录产生的影响也大相径庭。理解这两种策略的优缺点及适用场景，对于维护清晰、可追溯的 Git 历史以及高效的团队协作至关重要。  核心思想：git merge 通过创建新的合并提交来集成更改，保留了所有分支的历史；git rebase 通过重写提交历史将一个分支的提交应用到另一个分支的顶部，从而创建线性的历史记录。   一、Git Merge (合并)1.1 定义git merge 命令用于将来自一个或多个分支的独立开发历史合并到当前分支。它通过创建一个新的合并提交 (merge commit) 来实现这一点，这个合并提交的父提交指向两个被合并分支的最新提交。这意味着 git merge 会保留所有分支的原始提交历史，并显式地记录合并发生的时间和地点。 1.2 工作原理当执行 git merge &lt;branch_name&gt; 时：  Git 找到当前分支 (HEAD) ...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/8af9f3feb76a/" title="JVM 详解与调优"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-04.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-10-29</div><div class="info-item-2">JVM 详解与调优</div></div><div class="info-2"><div class="info-item-1"> Java 虚拟机 (JVM - Java Virtual Machine) 是 Java 程序运行的基石，它是一个抽象的计算机器，负责将 Java 字节码 (.class 文件) 翻译成机器指令并执行。JVM 屏蔽了底层操作系统的差异，实现了 Java 的“一次编译，到处运行” (Write Once, Run Anywhere) 的跨平台特性。深入理解 JVM 的架构、内存管理和垃圾回收机制，对于编写高性能、稳定可靠的 Java 应用程序至关重要，也是进行系统调优的基础。  核心思想：JVM 是 Java 程序的运行时环境，通过管理内存、执行字节码和进行垃圾回收，实现跨平台运行。JVM 调优的核心在于理解内存区域、垃圾回收器行为，并根据应用特性选择合适的参数，以平衡吞吐量、延迟和内存消耗。    一、JVM 架构概述JVM 架构主要由以下几个核心组件构成：      graph TD     A[Class Loader Subsystem - &lt;br&gt;类加载子系统] --&gt; B[Runtime Data Areas - &lt;br&gt;运行时数据区] ...</div></div></div></a><a class="pagination-related" href="/4a5f313d588b/" title="JDBC (Java Database Connectivity) 详解"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-10.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-01-20</div><div class="info-item-2">JDBC (Java Database Connectivity) 详解</div></div><div class="info-2"><div class="info-item-1"> JDBC (Java Database Connectivity) 是 Java 语言中用于访问关系型数据库的标准 Java API (应用程序编程接口)。它提供了一套统一的接口，允许 Java 应用程序以独立于数据库供应商的方式连接到各种关系型数据库（如 MySQL、Oracle、PostgreSQL、SQL Server 等），执行 SQL 语句，并处理查询结果。  核心思想：JDBC 提供了一个通用的抽象层，使得 Java 开发者可以使用一套标准的 API 来与任何支持 JDBC 规范的关系型数据库进行交互，而无需关心底层数据库的具体实现细节。    一、为什么需要 JDBC？在 JDBC 出现之前，Java 应用程序要连接和操作数据库，需要为每种数据库编写特定的代码。这意味着：  缺乏通用性：每更换一个数据库，应用程序的代码就需要大幅修改。 开发效率低：开发者需要熟悉不同数据库的私有 API。 维护成本高：代码难以维护和扩展。  JDBC 的目标就是解决这些问题，提供一个**“一次编写，处处运行” (Write Once, Run Anywhere)** 的数据库访问解...</div></div></div></a><a class="pagination-related" href="/1ce020133b41/" title="Java 泛型 (Generics) 详解"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-05.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-05-23</div><div class="info-item-2">Java 泛型 (Generics) 详解</div></div><div class="info-2"><div class="info-item-1"> Java 泛型 (Generics) 是在 JDK 5.0 中引入的一项重要语言特性，它允许在定义类、接口和方法时，使用类型参数 (Type Parameters) 来表示不确定的类型。这样，编译器可以在编译时对类型进行检查，从而在运行时避免 ClassCastException 等类型转换异常，提高了代码的类型安全性 (Type Safety)、重用性 (Reusability) 和可读性 (Readability)。  核心思想：Java 泛型通过引入类型参数，使得代码可以操作各种类型的数据而无需运行时强制类型转换，从而在编译时提供了更强的类型检查，减少了运行时错误，并提升了代码的通用性和安全性。    一、为什么需要泛型？在泛型出现之前，Java 集合框架（如 ArrayList, HashMap）可以存放任何类型的对象，因为它们操作的是 Object 类型。这带来了两个主要问题：  类型不安全：编译器无法检查集合中存储的实际类型。如果从集合中取出一个对象并强制转换为不正确的类型，就会在运行时抛出 ClassCastException。 代码冗余：每次从集合中取出对象时，...</div></div></div></a><a class="pagination-related" href="/0a6eb114d7c3/" title="Java 虚拟线程 (Virtual Threads) 详解 - Project Loom 的成果"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-15.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-22</div><div class="info-item-2">Java 虚拟线程 (Virtual Threads) 详解 - Project Loom 的成果</div></div><div class="info-2"><div class="info-item-1"> 虚拟线程 (Virtual Threads) 是 Java 平台在 JDK 21 中正式引入 的一项革命性并发特性（作为 Project Loom 1 的主要成果）。它旨在显著简化高吞吐量并发应用的开发和维护，通过提供轻量级的、由 JVM 管理的线程，解决传统平台线程在高并发场景下的性能瓶颈和资源消耗问题。  核心思想：虚拟线程让开发者能够继续沿用更直观的“一请求一线程 (thread-per-request)”的编程模型，同时获得接近异步编程的扩展能力。它将阻塞 I&#x2F;O 操作的开销从昂贵的操作系统线程转移到了 JVM 层面，从而在不改变代码风格的情况下，极大提升了服务器应用的并发吞吐量。   一、为什么需要虚拟线程？(传统并发的痛点)在 Java 历史上，处理并发主要依赖于传统的 平台线程 (Platform Threads)，也就是我们通常所说的 java.lang.Thread 类实例。这些线程直接映射到操作系统 (OS) 线程。 传统平台线程在高并发场景下存在以下痛点：  资源开销大：每个平台线程都需要操作系统分配独立的栈空间（通常 1MB 或更多），以及维护...</div></div></div></a><a class="pagination-related" href="/90e06403855b/" title="MyBatis (SQL Mapper Framework) 详解"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-27.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-01-22</div><div class="info-item-2">MyBatis (SQL Mapper Framework) 详解</div></div><div class="info-2"><div class="info-item-1"> MyBatis 是一款优秀的持久层框架，它避免了几乎所有的 JDBC 代码和手动设置参数以及获取结果集的工作。MyBatis 使用简单的 XML 或注解来配置和映射原始类型、Map 和 POJO 到数据库中的记录。它是一个 SQL Mapper 框架，强调 SQL 的灵活性和控制性，允许开发者完全掌控 SQL 语句，而不需要像全功能 ORM 框架（如 Hibernate）那样进行过度的抽象。  核心思想：MyBatis 提供了一个介于应用程序和数据库之间的桥梁，将 SQL 语句和应用程序代码解耦，并通过 XML 或注解定义 SQL 映射关系，实现数据对象的灵活持久化。它允许开发者编写高性能、可优化的定制化 SQL。    一、为什么需要 MyBatis？在 Java Web 开发中，持久层是处理数据存储和检索的关键部分。传统的 JDBC (Java Database Connectivity) 直接操作数据库，虽然提供了最大的灵活性，但存在以下痛点：  代码冗余和复杂：需要手动编写大量的模板代码来建立连接、创建 Statement、设置参数、处理 ResultSet、关闭资源等...</div></div></div></a><a class="pagination-related" href="/1d1a23609f01/" title="Java 内存泄漏详解"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-31.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-10-13</div><div class="info-item-2">Java 内存泄漏详解</div></div><div class="info-2"><div class="info-item-1"> Java 内存泄漏 (Memory Leak) 是指程序中已不再需要使用的对象，仍然被“根对象”链所引用，导致垃圾回收器无法对其进行回收，从而占用宝贵的堆内存。随着程序的运行，内存泄漏会不断累积，最终可能导致应用程序运行缓慢、响应迟钝，直至抛出 OutOfMemoryError (OOM) 错误而崩溃。  核心思想：内存泄漏的本质是“应该被回收但未被回收的对象”。理解 Java 垃圾回收机制和对象生命周期是诊断和避免内存泄漏的关键。    一、什么是内存泄漏？在 Java 中，我们通常不直接管理内存，而是依赖 JVM 的垃圾回收器 (GC) 自动回收不再使用的对象。一个对象是否“不再需要”，GC 通过可达性分析算法来判断：如果从 GC Roots 无法到达某个对象，则认为该对象是“垃圾”，可以被回收。 内存泄漏的定义：当一个对象实际上已经不再需要（即业务逻辑上它已经“死亡”），但从 GC Roots 到它仍然存在一条强引用链 (Strong Reference Chain)，导致 GC 无法回收它所占用的内存。 这种情况下，JVM 误认为该对象仍然“存活”，从而阻止了它的回收。...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/loading.gif" data-lazy-src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">TeaTang</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">536</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">229</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">84</div></a></div><a id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/teatang"><i class="fab fa-github"></i><span>GitHub主页</span></a><div class="card-info-social-icons"><a class="social-icon" href="mailto:tea.tang1211@gmail.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">网站更多功能即将上线，敬请期待！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E4%B8%8E-JUnit%EF%BC%9F"><span class="toc-text">一、为什么需要单元测试与 JUnit？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81JUnit-%E5%8F%91%E5%B1%95%E5%8E%86%E7%A8%8B-JUnit-4-vs-JUnit-5"><span class="toc-text">二、JUnit 发展历程 (JUnit 4 vs. JUnit 5)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-JUnit-4"><span class="toc-text">2.1 JUnit 4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-JUnit-5-JUnit-Jupiter"><span class="toc-text">2.2 JUnit 5 (JUnit Jupiter)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81JUnit-5-%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5%E4%B8%8E%E6%B3%A8%E8%A7%A3"><span class="toc-text">三、JUnit 5 核心概念与注解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-Maven-%E4%BE%9D%E8%B5%96-pom-xml"><span class="toc-text">3.1 Maven 依赖 (pom.xml)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E6%A0%B8%E5%BF%83%E6%B3%A8%E8%A7%A3"><span class="toc-text">3.2 核心注解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E5%B8%B8%E7%94%A8%E6%96%AD%E8%A8%80-Assertions"><span class="toc-text">3.3 常用断言 (Assertions)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81JUnit-5-%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81"><span class="toc-text">四、JUnit 5 示例代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81JUnit-5-%E8%BF%9B%E9%98%B6%E5%8A%9F%E8%83%BD"><span class="toc-text">五、JUnit 5 进阶功能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E5%8F%82%E6%95%B0%E5%8C%96%E6%B5%8B%E8%AF%95-ParameterizedTest"><span class="toc-text">5.1 参数化测试 (@ParameterizedTest)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E5%B5%8C%E5%A5%97%E6%B5%8B%E8%AF%95-Nested"><span class="toc-text">5.2 嵌套测试 (@Nested)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E6%A0%87%E7%AD%BE-Tag"><span class="toc-text">5.3 标签 (@Tag)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E6%B5%8B%E8%AF%95%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91-TDD-%E7%AE%80%E4%BB%8B"><span class="toc-text">六、测试驱动开发 (TDD) 简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-text">七、最佳实践</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E6%80%BB%E7%BB%93"><span class="toc-text">八、总结</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/8fc7e3e72510/" title="前端渲染模式：CSR, SSR, SSG, ISR, DPR 详解"><img src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-16.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="前端渲染模式：CSR, SSR, SSG, ISR, DPR 详解"/></a><div class="content"><a class="title" href="/8fc7e3e72510/" title="前端渲染模式：CSR, SSR, SSG, ISR, DPR 详解">前端渲染模式：CSR, SSR, SSG, ISR, DPR 详解</a><time datetime="2026-01-27T22:24:00.000Z" title="发表于 2026-01-28 06:24:00">2026-01-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/5341a0037256/" title="CSS-in-JS 详解"><img src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-20.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CSS-in-JS 详解"/></a><div class="content"><a class="title" href="/5341a0037256/" title="CSS-in-JS 详解">CSS-in-JS 详解</a><time datetime="2026-01-25T22:24:00.000Z" title="发表于 2026-01-26 06:24:00">2026-01-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/0b52cb819619/" title="Git 核心对象：Commit, Tree, Blob 详解"><img src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-26.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Git 核心对象：Commit, Tree, Blob 详解"/></a><div class="content"><a class="title" href="/0b52cb819619/" title="Git 核心对象：Commit, Tree, Blob 详解">Git 核心对象：Commit, Tree, Blob 详解</a><time datetime="2026-01-21T22:24:00.000Z" title="发表于 2026-01-22 06:24:00">2026-01-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/1d2a942bda1e/" title="Terraform 详解"><img src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-05.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Terraform 详解"/></a><div class="content"><a class="title" href="/1d2a942bda1e/" title="Terraform 详解">Terraform 详解</a><time datetime="2026-01-19T22:24:00.000Z" title="发表于 2026-01-20 06:24:00">2026-01-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/26cdb2447b3d/" title="WebView 详解"><img src="/img/loading.gif" data-lazy-src="/img/cover/default_cover-13.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="WebView 详解"/></a><div class="content"><a class="title" href="/26cdb2447b3d/" title="WebView 详解">WebView 详解</a><time datetime="2026-01-17T22:24:00.000Z" title="发表于 2026-01-18 06:24:00">2026-01-18</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/cover/default_cover-27.jpg);"><div class="footer-flex"><div class="footer-flex-items"><div class="footer-flex-item"><div class="footer-flex-title">我的轨迹</div><div class="footer-flex-content"><a href="/archives/2023/" target="_blank" title="🆕 2023">🆕 2023</a><a href="/archives/2024/" target="_blank" title="🆒 2024">🆒 2024</a><a href="/archives/2025/" target="_blank" title="👨‍👩‍👦 2025">👨‍👩‍👦 2025</a><a href="/archives/2026/" target="_blank" title="🆙 2026">🆙 2026</a></div></div></div><div class="footer-flex-items"><div class="footer-flex-item"><div class="footer-flex-title">维度</div><div class="footer-flex-content"><a href="/categories/" target="_blank" title="📁 分类">📁 分类</a><a href="/tags/" target="_blank" title="🔖 标签">🔖 标签</a><a href="/categories/" target="_blank" title="📽️ 时间线">📽️ 时间线</a></div></div></div><div class="footer-flex-items"><div class="footer-flex-item"><div class="footer-flex-title">其他</div><div class="footer-flex-content"><a href="/shuoshuo" target="_blank" title="💬 说说">💬 说说</a></div></div></div></div><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2023 - 2026 By TeaTang</span><span class="framework-info"><span class="footer-separator">|</span><span>框架 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.4"></script><script src="/js/main.js?v=5.5.4"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1.9/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@19.1.3/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(() => {
  const parseViewBox = viewBox => {
    if (!viewBox) return null
    const parts = viewBox.trim().split(/[\s,]+/).map(n => Number(n))
    if (parts.length !== 4 || parts.some(n => Number.isNaN(n))) return null
    return parts
  }

  const getSvgViewBox = svg => {
    const attr = parseViewBox(svg.getAttribute('viewBox'))
    if (attr) return attr

    // Fallback: use bbox to build a viewBox
    try {
      const bbox = svg.getBBox()
      if (bbox && bbox.width && bbox.height) return [bbox.x, bbox.y, bbox.width, bbox.height]
    } catch (e) {
      // getBBox may fail on some edge cases; ignore
    }

    const w = Number(svg.getAttribute('width')) || 0
    const h = Number(svg.getAttribute('height')) || 0
    if (w > 0 && h > 0) return [0, 0, w, h]
    return [0, 0, 100, 100]
  }

  const setSvgViewBox = (svg, vb) => {
    svg.setAttribute('viewBox', `${vb[0]} ${vb[1]} ${vb[2]} ${vb[3]}`)
  }

  const clamp = (v, min, max) => Math.max(min, Math.min(max, v))

  const openSvgInNewTab = ({ source, initViewBox }) => {
    const getClonedSvg = () => {
      if (typeof source === 'string') {
        const template = document.createElement('template')
        template.innerHTML = source.trim()
        const svg = template.content.querySelector('svg')
        return svg ? svg.cloneNode(true) : null
      }
      if (source && typeof source.cloneNode === 'function') {
        return source.cloneNode(true)
      }
      return null
    }

    const clone = getClonedSvg()
    if (!clone) return
    if (initViewBox && initViewBox.length === 4) {
      clone.setAttribute('viewBox', initViewBox.join(' '))
    }
    if (!clone.getAttribute('xmlns')) clone.setAttribute('xmlns', 'http://www.w3.org/2000/svg')
    if (!clone.getAttribute('xmlns:xlink') && clone.outerHTML.includes('xlink:')) {
      clone.setAttribute('xmlns:xlink', 'http://www.w3.org/1999/xlink')
    }
    // inject background to match current theme
    const isDark = document.documentElement.getAttribute('data-theme') === 'dark'
    const bg = getComputedStyle(document.body).backgroundColor || (isDark ? '#1e1e1e' : '#ffffff')
    if (!clone.style.background) clone.style.background = bg

    const serializer = new XMLSerializer()
    const svgSource = serializer.serializeToString(clone)
    const htmlSource = `<!doctype html><html><head><meta charset="utf-8" />
      <style>
        html, body { width: 100%; height: 100%; margin: 0; display: flex; align-items: center; justify-content: center; background: ${bg}; }
        svg { max-width: 100%; max-height: 100%; height: auto; width: auto; }
      </style>
      </head><body>${svgSource}</body></html>`
    const blob = new Blob([htmlSource], { type: 'text/html;charset=utf-8' })
    const url = URL.createObjectURL(blob)
    window.open(url, '_blank', 'noopener')
    setTimeout(() => URL.revokeObjectURL(url), 30000)
  }

  const attachMermaidViewerButton = wrap => {
    let btn = wrap.querySelector('.mermaid-open-btn')
    if (!btn) {
      btn = document.createElement('button')
      btn.type = 'button'
      btn.className = 'mermaid-open-btn'
      wrap.appendChild(btn)
    }

    btn.innerHTML = '<i class="fa fa-search fa-fw" aria-hidden="true"></i>'

    if (!btn.__mermaidViewerBound) {
      btn.addEventListener('click', e => {
        e.preventDefault()
        e.stopPropagation()
        const svg = wrap.__mermaidOriginalSvg || wrap.querySelector('svg')
        if (!svg) return
        const initViewBox = wrap.__mermaidInitViewBox
        if (typeof svg === 'string') {
          openSvgInNewTab({ source: svg, initViewBox })
          return
        }
        openSvgInNewTab({ source: svg, initViewBox })
      })
      btn.__mermaidViewerBound = true
    }
  }

  // Zoom around a point (px, py) in the SVG viewport (in viewBox coordinates)
  const zoomAtPoint = (vb, factor, px, py) => {
    const w = vb[2] * factor
    const h = vb[3] * factor
    const nx = px - (px - vb[0]) * factor
    const ny = py - (py - vb[1]) * factor
    return [nx, ny, w, h]
  }

  const initMermaidGestures = wrap => {
    const svg = wrap.querySelector('svg')
    if (!svg) return

    // Ensure viewBox exists so gestures always work
    const initVb = getSvgViewBox(svg)
    wrap.__mermaidInitViewBox = initVb
    wrap.__mermaidCurViewBox = initVb.slice()
    setSvgViewBox(svg, initVb)

    // Avoid binding multiple times on themeChange/pjax
    if (wrap.__mermaidGestureBound) return
    wrap.__mermaidGestureBound = true

    // Helper: map client (viewport) coordinate -> viewBox coordinate
    const clientToViewBox = (clientX, clientY) => {
      const rect = svg.getBoundingClientRect()
      const vb = wrap.__mermaidCurViewBox || getSvgViewBox(svg)
      const x = vb[0] + (clientX - rect.left) * (vb[2] / rect.width)
      const y = vb[1] + (clientY - rect.top) * (vb[3] / rect.height)
      return { x, y, rect, vb }
    }

    const state = {
      pointers: new Map(),
      startVb: null,
      startDist: 0,
      startCenter: null
    }

    const clampVb = vb => {
      const init = wrap.__mermaidInitViewBox || vb
      const minW = init[2] * 0.1
      const maxW = init[2] * 10
      const minH = init[3] * 0.1
      const maxH = init[3] * 10
      vb[2] = clamp(vb[2], minW, maxW)
      vb[3] = clamp(vb[3], minH, maxH)
      return vb
    }

    const setCurVb = vb => {
      vb = clampVb(vb)
      wrap.__mermaidCurViewBox = vb
      setSvgViewBox(svg, vb)
    }

    const onPointerDown = e => {
      // Allow only primary button for mouse
      if (e.pointerType === 'mouse' && e.button !== 0) return
      svg.setPointerCapture(e.pointerId)
      state.pointers.set(e.pointerId, { x: e.clientX, y: e.clientY })

      if (state.pointers.size === 1) {
        state.startVb = (wrap.__mermaidCurViewBox || getSvgViewBox(svg)).slice()
      } else if (state.pointers.size === 2) {
        const pts = [...state.pointers.values()]
        const dx = pts[0].x - pts[1].x
        const dy = pts[0].y - pts[1].y
        state.startDist = Math.hypot(dx, dy)
        state.startVb = (wrap.__mermaidCurViewBox || getSvgViewBox(svg)).slice()
        state.startCenter = { x: (pts[0].x + pts[1].x) / 2, y: (pts[0].y + pts[1].y) / 2 }
      }
    }

    const onPointerMove = e => {
      if (!state.pointers.has(e.pointerId)) return
      state.pointers.set(e.pointerId, { x: e.clientX, y: e.clientY })

      // Pan with 1 pointer
      if (state.pointers.size === 1 && state.startVb) {
        const p = [...state.pointers.values()][0]
        const prev = { x: e.clientX - e.movementX, y: e.clientY - e.movementY }
        // movementX/Y unreliable on touch, compute from stored last position
        const last = wrap.__mermaidLastSinglePointer || p
        const dxClient = p.x - last.x
        const dyClient = p.y - last.y
        wrap.__mermaidLastSinglePointer = p

        const { rect } = clientToViewBox(p.x, p.y)
        const vb = (wrap.__mermaidCurViewBox || getSvgViewBox(svg)).slice()
        const dx = dxClient * (vb[2] / rect.width)
        const dy = dyClient * (vb[3] / rect.height)
        setCurVb([vb[0] - dx, vb[1] - dy, vb[2], vb[3]])
        return
      }

      // Pinch zoom with 2 pointers
      if (state.pointers.size === 2 && state.startVb && state.startDist > 0) {
        const pts = [...state.pointers.values()]
        const dx = pts[0].x - pts[1].x
        const dy = pts[0].y - pts[1].y
        const dist = Math.hypot(dx, dy)
        if (!dist) return
        const factor = state.startDist / dist // dist bigger => zoom in (viewBox smaller)

        const cx = (pts[0].x + pts[1].x) / 2
        const cy = (pts[0].y + pts[1].y) / 2
        const centerClient = { x: cx, y: cy }

        const pxy = clientToViewBox(centerClient.x, centerClient.y)
        const cpx = pxy.x
        const cpy = pxy.y

        const vb = zoomAtPoint(state.startVb, factor, cpx, cpy)
        setCurVb(vb)
      }
    }

    const onPointerUpOrCancel = e => {
      state.pointers.delete(e.pointerId)
      if (state.pointers.size === 0) {
        state.startVb = null
        state.startDist = 0
        state.startCenter = null
        wrap.__mermaidLastSinglePointer = null
      } else if (state.pointers.size === 1) {
        // reset single pointer baseline to avoid jump
        wrap.__mermaidLastSinglePointer = [...state.pointers.values()][0]
      }
    }

    // Wheel zoom (mouse/trackpad)
    const onWheel = e => {
      // ctrlKey on mac trackpad pinch; we treat both as zoom
      e.preventDefault()
      const delta = e.deltaY
      const zoomFactor = delta > 0 ? 1.1 : 0.9
      const { x, y } = clientToViewBox(e.clientX, e.clientY)
      const vb = (wrap.__mermaidCurViewBox || getSvgViewBox(svg)).slice()
      setCurVb(zoomAtPoint(vb, zoomFactor, x, y))
    }

    const onDblClick = () => {
      const init = wrap.__mermaidInitViewBox
      if (!init) return
      wrap.__mermaidCurViewBox = init.slice()
      setSvgViewBox(svg, init)
    }

    svg.addEventListener('pointerdown', onPointerDown)
    svg.addEventListener('pointermove', onPointerMove)
    svg.addEventListener('pointerup', onPointerUpOrCancel)
    svg.addEventListener('pointercancel', onPointerUpOrCancel)
    svg.addEventListener('wheel', onWheel, { passive: false })
    svg.addEventListener('dblclick', onDblClick)
  }

  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild

      // Clear old render (themeChange/pjax will rerun)
      const oldSvg = item.querySelector('svg')
      if (oldSvg) oldSvg.remove()
      item.__mermaidGestureBound = false

      const config = mermaidSrc.dataset.config ? JSON.parse(mermaidSrc.dataset.config) : {}
      if (!config.theme) {
        config.theme = theme
      }
      const mermaidThemeConfig = `%%{init: ${JSON.stringify(config)}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
        if (false) initMermaidGestures(item)
        item.__mermaidOriginalSvg = svg
        if (true) attachMermaidViewerButton(item)
      }


      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (true) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid@11.12.2/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>(() => {
  const applyThemeDefaultsConfig = theme => {
    if (theme === 'dark-mode') {
      Chart.defaults.color = "rgba(255, 255, 255, 0.8)"
      Chart.defaults.borderColor = "rgba(255, 255, 255, 0.2)"
      Chart.defaults.scale.ticks.backdropColor = "transparent"
    } else {
      Chart.defaults.color = "rgba(0, 0, 0, 0.8)"
      Chart.defaults.borderColor = "rgba(0, 0, 0, 0.1)"
      Chart.defaults.scale.ticks.backdropColor = "transparent"
    }
  }

  // Recursively traverse the config object and automatically apply theme-specific color schemes
  const applyThemeConfig = (obj, theme) => {
    if (typeof obj !== 'object' || obj === null) return

    Object.keys(obj).forEach(key => {
      const value = obj[key]
      // If the property is an object and has theme-specific options, apply them
      if (typeof value === 'object' && value !== null) {
        if (value[theme]) {
          obj[key] = value[theme] // Apply the value for the current theme
        } else {
          // Recursively process child objects
          applyThemeConfig(value, theme)
        }
      }
    })
  }

  const runChartJS = ele => {
    window.loadChartJS = true

    Array.from(ele).forEach((item, index) => {
      const chartSrc = item.firstElementChild
      const chartID = item.getAttribute('data-chartjs-id') || ('chartjs-' + index) // Use custom ID or default ID
      const width = item.getAttribute('data-width')
      const existingCanvas = document.getElementById(chartID)

      // If a canvas already exists, remove it to avoid rendering duplicates
      if (existingCanvas) {
          existingCanvas.parentNode.remove()
      }

      const chartDefinition = chartSrc.textContent
      const canvas = document.createElement('canvas')
      canvas.id = chartID

      const div = document.createElement('div')
      div.className = 'chartjs-wrap'

      if (width) {
        div.style.width = width
      }

      div.appendChild(canvas)
      chartSrc.insertAdjacentElement('afterend', div)

      const ctx = document.getElementById(chartID).getContext('2d')

      const config = JSON.parse(chartDefinition)

      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark-mode' : 'light-mode'

      // Set default styles (initial setup)
      applyThemeDefaultsConfig(theme)

      // Automatically traverse the config and apply dual-mode color schemes
      applyThemeConfig(config, theme)

      new Chart(ctx, config)
    })
  }

  const loadChartJS = () => {
    const chartJSEle = document.querySelectorAll('#article-container .chartjs-container')
    if (chartJSEle.length === 0) return

    window.loadChartJS ? runChartJS(chartJSEle) : btf.getScript('https://cdn.jsdelivr.net/npm/chart.js@4.5.1/dist/chart.umd.min.js').then(() => runChartJS(chartJSEle))
  }

  // Listen for theme change events
  btf.addGlobalFn('themeChange', loadChartJS, 'chartjs')
  btf.addGlobalFn('encrypt', loadChartJS, 'chartjs')

  window.pjax ? loadChartJS() : document.addEventListener('DOMContentLoaded', loadChartJS)
})()</script></div><script data-pjax src="/self/btf.js"></script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/fireworks.min.js"></script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="ture"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,200,200" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js" defer="defer"></script><script>document.addEventListener('DOMContentLoaded', () => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => {
      try {
        fn()
      } catch (err) {
        console.debug('Pjax callback failed:', err)
      }
    })
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      true
        ? pjax.loadUrl('/404.html')
        : window.location.href = e.request.responseURL
    }
  })
})</script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="local-search-input"><input placeholder="搜索文章" type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.5.4"></script></div></div></body></html>